/*! For license information please see RosCard.js.LICENSE.txt */
(()=>{"use strict";var t={zh:{cardTitle:function(t){return"".concat(t||"未命名设备"," 卡片")},controlPanelTitle:"发送控制命令",sendButton:"发送",testButton:"测试",nameLabel:"设备名称: ",selectEntity:"请选择实体",selectCommand:"请选择命令",selectOption:"请选择选项",enterCommand:"请输入命令值...",clearButton:"清空",validEntity:"请选择有效实体",stateOn:"开",stateOff:"关",defaultIconPath:"/local/community/RosCard/icon_img/states_device_light_on_icon.png",entity:"实体",executionModes:{immediate:"立即执行",delayed:"延迟执行",popup:"弹窗询问"},independentDisplay:"是否独立显示",yes:"是",no:"否"},en:{cardTitle:function(t){return"".concat(t||"Unnamed Device"," Card")},controlPanelTitle:"Send Control Commands",sendButton:"Send",testButton:"Test",nameLabel:"Device Name: ",selectEntity:"Please select an entity",selectCommand:"Please select a command",selectOption:"Please select an option",enterCommand:"Enter command value...",clearButton:"Clear",validEntity:"Please select a valid entity",stateOn:"On",stateOff:"Off",defaultIconPath:"/local/community/RosCard/icon_img/states_device_light_on_icon.png",entity:"Entity",executionModes:{immediate:"Immediate",delayed:"Delayed",popup:"Popup Ask"},independentDisplay:"Show independently",yes:"Yes",no:"No"}};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,r(o.key),o)}}function r(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}function o(t){var e="function"==typeof Map?new Map:void 0;return o=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(i())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var o=new(t.bind.apply(t,r));return n&&a(o,n.prototype),o}(t,arguments,c(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)},o(t)}function i(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(i=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var u=function(r){function o(){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=function(t,n,r){return n=c(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,i()?Reflect.construct(n,r||[],c(t).constructor):n.apply(t,r))}(this,o)).firstRender=!0,n._language=navigator.language.startsWith("zh")?"zh":"en",n._translations=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(o,r),u=o,(l=[{key:"_createButton",value:function(t,e){var n=document.createElement("button");return n.innerText=t,n.style.margin="4px",n.style.padding="8px 12px",n.style.cursor="pointer",n.style.borderRadius="4px",n.onclick=e.bind(this),n}},{key:"_createIcon",value:function(t){var e=document.createElement("img");return e.src=t||this._translations[this._language].defaultIconPath,e.style.position="absolute",e.style.top="50px",e.style.right="30px",e.style.width="60px",e.style.height="60px",e}},{key:"_t",value:function(t){var e;return(null===(e=this._translations[this._language])||void 0===e?void 0:e[t])||""}}])&&n(u.prototype,l),Object.defineProperty(u,"prototype",{writable:!1}),u;var u,l}(o(HTMLElement));function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return f(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(f(e={},r,function(){return this}),e),d=l.prototype=c.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,f(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=l,f(d,"constructor",l),f(l,"constructor",u),u.displayName="GeneratorFunction",f(l,o,"GeneratorFunction"),f(d),f(d,o,"Generator"),f(d,r,function(){return this}),f(d,"toString",function(){return"[object Generator]"}),(s=function(){return{w:i,m:y}})()}function f(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}f=function(t,e,n,r){function i(e,n){f(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},f(t,e,n,r)}function p(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return v(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach(function(e){g(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function g(t,e,n){return(e=O(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,O(r.key),r)}}function O(t){var e=function(t){if("object"!=l(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==l(e)?e:e+""}function w(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(w=function(){return!!t})()}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}function E(t,e){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},E(t,e)}var P=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=j(e),function(t,e){if(e&&("object"==l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,w()?Reflect.construct(e,n||[],j(t).constructor):e.apply(t,n))}(this,e))._translations=m(m({},t._translations),{},{zh:m(m({},t._translations.zh),{},{mediaCommands:[{label:"播放",value:"media_play"},{label:"暂停",value:"media_pause"},{label:"音量增加",value:"volume_up"},{label:"音量减少",value:"volume_down"},{label:"静音",value:"volume_mute_true"},{label:"取消静音",value:"volume_mute_false"}]}),en:m(m({},t._translations.en),{},{mediaCommands:[{label:"Play",value:"media_play"},{label:"Pause",value:"media_pause"},{label:"Volume Up",value:"volume_up"},{label:"Volume Down",value:"volume_down"},{label:"Mute",value:"volume_mute_true"},{label:"Unmute",value:"volume_mute_false"}]})}),t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=m(m({},t),{},{tv_name:t.tv_name||("zh"===this._language?"未命名电视":"Unnamed TV"),entities:Array.isArray(null==t?void 0:t.entities)?y(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_tv.png",tv_type:t.tv_type||"android_tv"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.tv_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){"media_player"===e.type&&e.commands?Object.entries(e.commands).forEach(function(r){var o=d(r,2),i=o[0],a=o[1],c=document.createElement("div");c.innerHTML="<span>".concat(e.entity_id,": ").concat(i,"</span>");var u=t._createButton(t._translations[t._language].sendButton,function(){"volume_mute"===a?t._hass.callService(e.type,a,{entity_id:e.entity_id,is_volume_muted:!(!i.includes("静音")&&!i.includes("Mute"))}):t._hass.callService(e.type,a,{entity_id:e.entity_id})});c.appendChild(u),n.appendChild(c)}):"remote"===e.type&&e.commands?Object.entries(e.commands).forEach(function(r){var o=d(r,2),i=o[0],a=o[1],c=document.createElement("div");c.innerHTML="<span>".concat(e.entity_id,": ").concat(i," = ").concat(a,"</span>");var u=t._createButton(t._translations[t._language].testButton,function(){t._hass.callService(e.type,"send_command",{entity_id:e.entity_id,command:a})});c.appendChild(u),n.appendChild(c)}):"select"===e.type&&e.commands&&Object.entries(e.commands).forEach(function(r){var o=d(r,2),i=o[0],a=o[1],c=document.createElement("div");c.innerHTML="<span>".concat(e.entity_id,": ").concat(i," = ").concat(a,"</span>");var u=t._createButton(t._translations[t._language].testButton,function(){t._hass.callService(e.type,"select_option",{entity_id:e.entity_id,option:a})});c.appendChild(u),n.appendChild(c)})}),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=s().m(function t(){return s().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-tv-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){p(o,n,r,a,c,"next",t)}function c(t){p(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{tv_name:"zh"==(navigator.language.startsWith("zh")?"zh":"en")?"未命名电视":"Unnamed TV",entities:[],tv_type:"android_tv",media_play_entity:""}}}],r&&_(n.prototype,r),o&&_(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function C(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return T(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach(function(e){I(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,M(r.key),r)}}function D(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(D=function(){return!!t})()}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R(t)}function L(t,e){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},L(t,e)}function I(t,e,n){return(e=M(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M(t){var e=function(t){if("object"!=S(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(e)?e:e+""}var B=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=R(e),function(t,e){if(e&&("object"==S(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,D()?Reflect.construct(e,n||[],R(t).constructor):e.apply(t,n))}(this,e))._translations=A(A({},t._translations),{},{zh:A(A({},t._translations.zh),{},{mediaCommands:[{label:"播放",value:"media_play"},{label:"暂停",value:"media_pause"},{label:"音量增加",value:"volume_up"},{label:"音量减少",value:"volume_down"},{label:"静音",value:"volume_mute_true"},{label:"取消静音",value:"volume_mute_false"}]}),en:A(A({},t._translations.en),{},{mediaCommands:[{label:"Play",value:"media_play"},{label:"Pause",value:"media_pause"},{label:"Volume Up",value:"volume_up"},{label:"Volume Down",value:"volume_down"},{label:"Mute",value:"volume_mute_true"},{label:"Unmute",value:"volume_mute_false"}]})}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L(t,e)}(e,t),n=e,r=[{key:"generateUUID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}},{key:"setConfig",value:function(t){var e=A({},t);e.id||(e.id=this.generateUUID()),this._config={type:e.type||"custom:aiks-tv-card",id:e.id,tv_type:e.tv_type||"android_tv",tv_name:e.tv_name||("zh"===this._language?"未命名电视":"Unnamed TV"),media_play_entity:e.media_play_entity||"",entities:Array.isArray(e.entities)?C(e.entities):[]},this.dispatchEvent(new CustomEvent("config-changed",{detail:{config:A({},this._config)}})),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.style.marginBottom="10px",n.style.display="flex",n.style.alignItems="center";var r=document.createElement("span");r.innerText="zh"===this._language?"设备类型: ":"Device Type: ",r.style.width="100px",n.appendChild(r);var o=document.createElement("select");if(o.style.width="120px",[{value:"apple_tv",label:(this._language,"Apple TV")},{value:"android_tv",label:"zh"===this._language?"安卓电视":"Android TV"}].forEach(function(e){var n=document.createElement("option");n.value=e.value,n.text=e.label,t._config.tv_type===e.value&&(n.selected=!0),o.appendChild(n)}),o.addEventListener("change",function(){t._config.tv_type=o.value,"android_tv"===o.value&&(t._config.media_play_entity=""),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:A({},t._config)}})),t.render()}),n.appendChild(o),e.appendChild(n),"apple_tv"===this._config.tv_type){var i=document.createElement("div");i.style.marginBottom="10px",i.style.display="flex",i.style.alignItems="center";var a=document.createElement("span");a.innerText="zh"===this._language?"播放实体: ":"Media Player: ",a.style.width="100px",i.appendChild(a);var c=document.createElement("select");c.style.width="200px",c.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(e){if(e.startsWith("media_player.")){var n,r=document.createElement("option");r.value=e,r.text=(null===(n=t._hass.states[e])||void 0===n||null===(n=n.attributes)||void 0===n?void 0:n.friendly_name)||e,e===t._config.media_play_entity&&(r.selected=!0),c.appendChild(r)}}),c.addEventListener("change",function(){t._config.media_play_entity=c.value,t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:A({},t._config)}}))}),i.appendChild(c),e.appendChild(i)}var u=document.createElement("div");u.style.marginBottom="10px",u.style.display="flex",u.style.alignItems="center";var l=document.createElement("span");l.innerText=this._translations[this._language].nameLabel,l.style.width="100px",u.appendChild(l);var s=document.createElement("input");s.type="text",s.value=this._config.tv_name,s.style.width="200px",s.addEventListener("blur",function(){t._config.tv_name=s.value,t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:A({},t._config)}}))}),u.appendChild(s),e.appendChild(u);var f=document.createElement("div");f.id="entityContainer",this._config.entities=["POWER","UP","DOWN","LEFT","RIGHT","ENTER","BACK","PLAY","PAUSE","VOLUME_UP","VOLUME_DOWN","MUTE","UN_MUTE","SETTINGS","HOME","MENU"].map(function(e,n){return t._config.entities[n]||{key:e,type:"",entity_id:"",value:""}}),this._config.entities.forEach(function(e,n){f.appendChild(t._createEntityRow(n,e,t._hass))}),e.appendChild(f),this.appendChild(e)}}},{key:"_showToast",value:function(t){try{this.dispatchEvent(new CustomEvent("show-toast",{detail:{message:t}}))}catch(e){console.warn(t)}}},{key:"_sendTest",value:function(t,e){var n,r=this._hass;if(r){var o=(null==t?void 0:t.entity_id)||"",i=o?o.split(".")[0]:(null==t?void 0:t.type)||"",a=(null!==(n=null!=e?e:null==t?void 0:t.value)&&void 0!==n?n:"").toString().trim();if(o&&i)if(a||"media_player"===i)if("remote"!==i)if("media_player"!==i)"select"!==i?this._showToast("不支持的类型：".concat(i)):r.callService("select","select_option",{entity_id:o,option:a});else if("volume_mute_true"===a||"volume_mute_false"===a)r.callService("media_player","volume_mute",{entity_id:o,is_volume_muted:a.endsWith("_true")});else if(a.startsWith("volume_set_")){var c=parseFloat(a.split("_").pop());Number.isNaN(c)?this._showToast("音量格式应为 volume_set_0.0~1.0"):r.callService("media_player","volume_set",{entity_id:o,volume_level:Math.max(0,Math.min(1,c))})}else r.callService("media_player",a||"media_play",{entity_id:o});else r.callService("remote","send_command",{entity_id:o,command:a});else this._showToast("请先填写命令/选项");else this._showToast("请先选择实体")}else this._showToast("hass 未就绪")}},{key:"_createEntityRow",value:function(t,n,r){var o=this,i=document.createElement("div");i.style.marginBottom="10px",i.style.display="flex",i.style.alignItems="center";var a=document.createElement("span");a.innerText="".concat(n.key,": "),a.style.width="100px",i.appendChild(a);var c=document.createElement("select");c.style.width="200px",c.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(r.states).forEach(function(t){if(t.startsWith("media_player.")||t.startsWith("remote.")||t.startsWith("select.")){var e,o=document.createElement("option");o.value=t,o.text=(null===(e=r.states[t])||void 0===e||null===(e=e.attributes)||void 0===e?void 0:e.friendly_name)||t,t===n.entity_id&&(o.selected=!0),c.appendChild(o)}}),i.appendChild(c);var u=document.createElement("div");u.style.marginLeft="10px",i.appendChild(u);var l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=o._config.entities.map(function(n,r){return r===t?A(A({},n),e):n});o._config=A(A({},o._config),{},{entities:n}),o.dispatchEvent(new CustomEvent("config-changed",{detail:{config:o._config},bubbles:!0,composed:!0}))},s=function(){var t;u.innerHTML="";var i=c.value,a=i?i.split(".")[0]:"",s=null;if("media_player"===a){var f=document.createElement("select");f.style.width="200px",f.innerHTML='<option value="">'.concat(o._translations[o._language].selectCommand,"</option>"),o._translations[o._language].mediaCommands.forEach(function(t){var e=document.createElement("option");e.value=t.value,e.text=t.label,t.value===n.value&&(e.selected=!0),f.appendChild(e)}),f.addEventListener("change",function(){return l({value:f.value})}),u.appendChild(f),s=f}else if("select"===a&&null!==(t=r.states[i])&&void 0!==t&&null!==(t=t.attributes)&&void 0!==t&&t.options){var p=document.createElement("select");p.style.width="200px",p.innerHTML='<option value="">'.concat(o._translations[o._language].selectOption,"</option>"),r.states[i].attributes.options.forEach(function(t){var e=document.createElement("option");e.value=t,e.text=t,t===n.value&&(e.selected=!0),p.appendChild(e)}),p.addEventListener("change",function(){return l({value:p.value})}),u.appendChild(p),s=p}else if("remote"===a){var d=document.createElement("input");if(d.type="text",n.value)d.value=n.value;else{var y,h=o._config.tv_type||"android_tv",v=(null===(y=e.REMOTE_DEFAULTS)||void 0===y||null===(y=y[h])||void 0===y?void 0:y[n.key])||"";d.value=v,l({value:v})}d.style.width="200px",d.placeholder=o._translations[o._language].enterCommand,d.addEventListener("input",function(){return l({value:d.value})}),u.appendChild(d);var b=o._createButton("zh"===o._language?"恢复默认":"Reset Default",function(){var t,r=o._config.tv_type||"android_tv",i=(null===(t=e.REMOTE_DEFAULTS)||void 0===t||null===(t=t[r])||void 0===t?void 0:t[n.key])||"";d.value=i,l({value:i})});u.appendChild(b);var m=o._createButton(o._translations[o._language].testButton,function(){return o._sendTest({key:n.key,type:a,entity_id:c.value,value:d.value},d.value)});u.appendChild(m)}else u.innerHTML="<span>".concat(o._translations[o._language].validEntity,"</span>");if(s){var g=o._createButton(o._translations[o._language].testButton,function(){return o._sendTest({key:n.key,type:a,entity_id:c.value,value:s.value},s.value)});u.appendChild(g)}};return c.addEventListener("change",function(){var t=c.value||"",r=t?t.split(".")[0]:"",i={entity_id:t,type:r};if("remote"===r){var a,u=o._config.tv_type||"android_tv";i.value=(null===(a=e.REMOTE_DEFAULTS)||void 0===a||null===(a=a[u])||void 0===a?void 0:a[n.key])||""}l(i),s()}),n.entity_id&&(c.value=n.entity_id,s()),i}}],r&&k(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function U(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return G(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(G(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,G(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,G(f,"constructor",l),G(l,"constructor",u),u.displayName="GeneratorFunction",G(l,o,"GeneratorFunction"),G(f),G(f,o,"Generator"),G(f,r,function(){return this}),G(f,"toString",function(){return"[object Generator]"}),(U=function(){return{w:i,m:p}})()}function G(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}G=function(t,e,n,r){function i(e,n){G(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},G(t,e,n,r)}function z(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function N(t){return function(t){if(Array.isArray(t))return W(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return W(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function $(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach(function(e){V(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function V(t,e,n){return(e=Y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Y(r.key),r)}}function Y(t){var e=function(t){if("object"!=H(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=H(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==H(e)?e:e+""}function K(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(K=function(){return!!t})()}function J(t){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},J(t)}function Q(t,e){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Q(t,e)}I(B,"REMOTE_DEFAULTS",{android_tv:{POWER:"POWER",UP:"UP",DOWN:"DOWN",LEFT:"LEFT",RIGHT:"RIGHT",ENTER:"ENTER",BACK:"BACK",PLAY:"PLAY",PAUSE:"PAUSE",VOLUME_UP:"VOLUME_UP",VOLUME_DOWN:"VOLUME_DOWN",MUTE:"MUTE",UN_MUTE:"UNMUTE",SETTINGS:"SETTINGS",HOME:"HOME",MENU:"MENU"},apple_tv:{POWER:"suspend",UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",ENTER:"select",BACK:"menu",PLAY:"play",PAUSE:"pause",VOLUME_UP:"volume_up",VOLUME_DOWN:"volume_down",MUTE:"mute",UN_MUTE:"",SETTINGS:"wakeup",HOME:"home",MENU:"menu"}});var X=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=J(e),function(t,e){if(e&&("object"==H(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,K()?Reflect.construct(e,n||[],J(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=$($({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?N(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_light.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass&&this._config){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle("zh"===this._language?"灯光控制":"Light Control"),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",this._config.entities.length>0?this._config.entities.forEach(function(e){var r,o=(null===(r=t._hass.states[e.entity_id])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||e.entity_id,i=document.createElement("div");i.style.marginBottom="10px",i.innerHTML="<div>".concat(t._translations[t._language].entity,": ").concat(o,"</div>"),n.appendChild(i)}):n.innerHTML="<div>".concat(this._translations[this._language].validEntity,"</div>"),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=U().m(function t(){return U().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-light-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){z(o,n,r,a,c,"next",t)}function c(t){z(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&q(n.prototype,r),o&&q(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function tt(t){return function(t){if(Array.isArray(t))return nt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||et(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(t,e){if(t){if("string"==typeof t)return nt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nt(t,e):void 0}}function nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function ot(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach(function(e){it(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function it(t,e,n){return(e=ct(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ct(r.key),r)}}function ct(t){var e=function(t){if("object"!=Z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Z(e)?e:e+""}function ut(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ut=function(){return!!t})()}function lt(t){return lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lt(t)}function st(t,e){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},st(t,e)}var ft=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=lt(e),function(t,e){if(e&&("object"==Z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ut()?Reflect.construct(e,n||[],lt(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&st(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=ot(ot({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?tt(t.entities):[]}),this._config.entities=this._config.entities.map(function(t){return ot(ot({},t),{},{independent_display:!0===t.independent_display})}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加设备":"Add Device",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("light.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=tt(n._config.entities);e[t]=ot(ot({},e[t]),{},{entity_id:i.value}),n._config=ot(ot({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ot({},n._config)}})),n.render()}),r.appendChild(i);var a=document.createElement("label");a.style.marginLeft="10px",a.style.display="inline-flex",a.style.alignItems="center",a.style.gap="6px";var c=document.createElement("input");c.type="checkbox",c.checked=!!e.independent_display;var u=document.createElement("span");u.textContent=this._translations[this._language].independentDisplay,a.appendChild(c),a.appendChild(u),r.appendChild(a),c.addEventListener("change",function(){var e=tt(n._config.entities);e[t]=ot(ot({},e[t]),{},{independent_display:c.checked}),n._config=ot(ot({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ot({},n._config)}}))});var l=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=tt(n._config.entities);e.splice(t,1),n._config=ot(ot({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ot({},n._config)}})),n.render()});return r.appendChild(l),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=tt(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||et(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=ot(ot({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ot({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&at(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function dt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return yt(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(yt(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,yt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,yt(f,"constructor",l),yt(l,"constructor",u),u.displayName="GeneratorFunction",yt(l,o,"GeneratorFunction"),yt(f),yt(f,o,"Generator"),yt(f,r,function(){return this}),yt(f,"toString",function(){return"[object Generator]"}),(dt=function(){return{w:i,m:p}})()}function yt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}yt=function(t,e,n,r){function i(e,n){yt(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},yt(t,e,n,r)}function ht(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function vt(t){return function(t){if(Array.isArray(t))return bt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return bt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function mt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mt(Object(n),!0).forEach(function(e){_t(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _t(t,e,n){return(e=wt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wt(r.key),r)}}function wt(t){var e=function(t){if("object"!=pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(e)?e:e+""}function jt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(jt=function(){return!!t})()}function Et(t){return Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Et(t)}function Pt(t,e){return Pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pt(t,e)}var St=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Et(e),function(t,e){if(e&&("object"==pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,jt()?Reflect.construct(e,n||[],Et(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pt(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=gt(gt({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?vt(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_fan.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass&&this._config){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle("zh"===this._language?"风扇控制":"Fan Control"),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",this._config.entities.length>0?this._config.entities.forEach(function(e){var r,o=(null===(r=t._hass.states[e.entity_id])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||e.entity_id,i=document.createElement("div");i.style.marginBottom="10px",i.innerHTML="<div>".concat(t._translations[t._language].entity,": ").concat(o,"</div>"),n.appendChild(i)}):n.innerHTML="<div>".concat(this._translations[this._language].validEntity,"</div>"),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=dt().m(function t(){return dt().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-fan-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){ht(o,n,r,a,c,"next",t)}function c(t){ht(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Ot(n.prototype,r),o&&Ot(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function Ct(t){return Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ct(t)}function Tt(t){return function(t){if(Array.isArray(t))return At(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||xt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(t,e){if(t){if("string"==typeof t)return At(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(t,e):void 0}}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function kt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kt(Object(n),!0).forEach(function(e){Rt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Rt(t,e,n){return(e=It(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,It(r.key),r)}}function It(t){var e=function(t){if("object"!=Ct(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ct(e)?e:e+""}function Mt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Mt=function(){return!!t})()}function Bt(t){return Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(t)}function Ht(t,e){return Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ht(t,e)}var Ut=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Bt(e),function(t,e){if(e&&("object"==Ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Mt()?Reflect.construct(e,n||[],Bt(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ht(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Dt(Dt({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Tt(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加设备":"Add Device",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("fan.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=Tt(n._config.entities);e[t]=Dt(Dt({},e[t]),{},{entity_id:i.value}),n._config=Dt(Dt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Dt({},n._config)}})),n.render()}),r.appendChild(i);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Tt(n._config.entities);e.splice(t,1),n._config=Dt(Dt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Dt({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=Tt(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||xt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=Dt(Dt({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Dt({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&Lt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function zt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Nt(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Nt(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Nt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Nt(f,"constructor",l),Nt(l,"constructor",u),u.displayName="GeneratorFunction",Nt(l,o,"GeneratorFunction"),Nt(f),Nt(f,o,"Generator"),Nt(f,r,function(){return this}),Nt(f,"toString",function(){return"[object Generator]"}),(zt=function(){return{w:i,m:p}})()}function Nt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Nt=function(t,e,n,r){function i(e,n){Nt(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},Nt(t,e,n,r)}function Wt(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Ft(t){return function(t){if(Array.isArray(t))return $t(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $t(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$t(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Vt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function qt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vt(Object(n),!0).forEach(function(e){Yt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Yt(t,e,n){return(e=Jt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Jt(r.key),r)}}function Jt(t){var e=function(t){if("object"!=Gt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gt(e)?e:e+""}function Qt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Qt=function(){return!!t})()}function Xt(t){return Xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xt(t)}function Zt(t,e){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zt(t,e)}var te=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Xt(e),function(t,e){if(e&&("object"==Gt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qt()?Reflect.construct(e,n||[],Xt(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zt(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=qt(qt({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Ft(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_scene.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass&&this._config){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle("zh"===this._language?"场景控制":"Scene Control"),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",this._config.entities.length>0?this._config.entities.forEach(function(e){var r,o=(null===(r=t._hass.states[e.entity_id])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||e.entity_id,i=document.createElement("div");i.style.marginBottom="10px",i.innerHTML="<div>".concat(t._translations[t._language].entity,": ").concat(o,"</div>"),n.appendChild(i)}):n.innerHTML="<div>".concat(this._translations[this._language].validEntity,"</div>"),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=zt().m(function t(){return zt().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-scene-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){Wt(o,n,r,a,c,"next",t)}function c(t){Wt(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Kt(n.prototype,r),o&&Kt(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function ne(t){return function(t){if(Array.isArray(t))return oe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||re(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(t,e){if(t){if("string"==typeof t)return oe(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(t,e):void 0}}function oe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function ae(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(n),!0).forEach(function(e){ce(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ce(t,e,n){return(e=le(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,le(r.key),r)}}function le(t){var e=function(t){if("object"!=ee(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ee(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ee(e)?e:e+""}function se(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(se=function(){return!!t})()}function fe(t){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fe(t)}function pe(t,e){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pe(t,e)}var de=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=fe(e),function(t,e){if(e&&("object"==ee(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,se()?Reflect.construct(e,n||[],fe(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pe(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=ae(ae({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?ne(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加场景":"Add Scene",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("scene.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=ne(n._config.entities);e[t]=ae(ae({},e[t]),{},{entity_id:i.value}),n._config=ae(ae({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ae({},n._config)}})),n.render()}),r.appendChild(i);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=ne(n._config.entities);e.splice(t,1),n._config=ae(ae({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ae({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=ne(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||re(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=ae(ae({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ae({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&ue(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function he(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return ve(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(ve(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,ve(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,ve(f,"constructor",l),ve(l,"constructor",u),u.displayName="GeneratorFunction",ve(l,o,"GeneratorFunction"),ve(f),ve(f,o,"Generator"),ve(f,r,function(){return this}),ve(f,"toString",function(){return"[object Generator]"}),(he=function(){return{w:i,m:p}})()}function ve(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}ve=function(t,e,n,r){function i(e,n){ve(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},ve(t,e,n,r)}function be(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function me(t){return function(t){if(Array.isArray(t))return ge(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ge(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function _e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(n),!0).forEach(function(e){we(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function we(t,e,n){return(e=Ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function je(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ee(r.key),r)}}function Ee(t){var e=function(t){if("object"!=ye(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ye(e)?e:e+""}function Pe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Pe=function(){return!!t})()}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Se(t)}function Ce(t,e){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ce(t,e)}var Te=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Se(e),function(t,e){if(e&&("object"==ye(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Pe()?Reflect.construct(e,n||[],Se(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ce(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Oe(Oe({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?me(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_media_play1.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass&&this._config){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle("zh"===this._language?"媒体播放器控制":"Media Player Control"),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",this._config.entities.length>0?this._config.entities.forEach(function(e){var r,o=(null===(r=t._hass.states[e.entity_id])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||e.entity_id,i=document.createElement("div");i.style.marginBottom="10px",i.innerHTML="<div>".concat(t._translations[t._language].entity,": ").concat(o,"</div>"),n.appendChild(i)}):n.innerHTML="<div>".concat(this._translations[this._language].validEntity,"</div>"),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=he().m(function t(){return he().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-media-player-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){be(o,n,r,a,c,"next",t)}function c(t){be(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&je(n.prototype,r),o&&je(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function xe(t){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(t)}function Ae(t){return function(t){if(Array.isArray(t))return De(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ke(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(t,e){if(t){if("string"==typeof t)return De(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?De(t,e):void 0}}function De(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Re(Object(n),!0).forEach(function(e){Ie(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ie(t,e,n){return(e=Be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Me(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Be(r.key),r)}}function Be(t){var e=function(t){if("object"!=xe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=xe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xe(e)?e:e+""}function He(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(He=function(){return!!t})()}function Ue(t){return Ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ue(t)}function Ge(t,e){return Ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ge(t,e)}var ze=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Ue(e),function(t,e){if(e&&("object"==xe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,He()?Reflect.construct(e,n||[],Ue(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ge(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Le(Le({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Ae(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加播放器":"Add Media Player",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("media_player.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=Ae(n._config.entities);e[t]=Le(Le({},e[t]),{},{entity_id:i.value}),n._config=Le(Le({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Le({},n._config)}})),n.render()}),r.appendChild(i);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Ae(n._config.entities);e.splice(t,1),n._config=Le(Le({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Le({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=Ae(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||ke(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=Le(Le({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Le({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&Me(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Ne(t){return Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ne(t)}function We(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Fe(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Fe(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Fe(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Fe(f,"constructor",l),Fe(l,"constructor",u),u.displayName="GeneratorFunction",Fe(l,o,"GeneratorFunction"),Fe(f),Fe(f,o,"Generator"),Fe(f,r,function(){return this}),Fe(f,"toString",function(){return"[object Generator]"}),(We=function(){return{w:i,m:p}})()}function Fe(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Fe=function(t,e,n,r){function i(e,n){Fe(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},Fe(t,e,n,r)}function $e(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Ve(t){return function(t){if(Array.isArray(t))return qe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return qe(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qe(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ye(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ye(Object(n),!0).forEach(function(e){Je(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Je(t,e,n){return(e=Xe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xe(r.key),r)}}function Xe(t){var e=function(t){if("object"!=Ne(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ne(e)?e:e+""}function Ze(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ze=function(){return!!t})()}function tn(t){return tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tn(t)}function en(t,e){return en=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},en(t,e)}var nn=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=tn(e),function(t,e){if(e&&("object"==Ne(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ze()?Reflect.construct(e,n||[],tn(t).constructor):e.apply(t,n))}(this,e))._translations={zh:Ke(Ke({},t._translations.zh),{},{temperature:"温度",humidity:"湿度",mode:"模式"}),en:Ke(Ke({},t._translations.en),{},{temperature:"Temperature",humidity:"Humidity",mode:"Mode"})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&en(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Ke(Ke({},t),{},{climate_name:t.climate_name||("zh"===this._language?"未命名空调":"Unnamed AC"),entities:Array.isArray(null==t?void 0:t.entities)?Ve(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_climate.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.climate_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("climate.")){var r,o,i=t._hass.states[e.entity_id],a=document.createElement("div");a.style.marginBottom="12px",a.style.padding="8px",a.style.border="1px solid #ddd",a.style.borderRadius="4px";var c=(null==i||null===(r=i.attributes)||void 0===r?void 0:r.current_temperature)||"--",u=(null==i||null===(o=i.attributes)||void 0===o?void 0:o.temperature)||"--";a.innerHTML='\n            <div style="margin-bottom: 8px;">\n              <strong>'.concat(e.entity_id,"</strong><br/>\n              ").concat(t._translations[t._language].temperature,": ").concat(c,"°C → ").concat(u,"°C\n            </div>\n          ");var l=t._createButton("On",function(){t._hass.callService("climate","turn_on",{entity_id:e.entity_id})}),s=t._createButton("Off",function(){t._hass.callService("climate","turn_off",{entity_id:e.entity_id})});a.appendChild(l),a.appendChild(s),n.appendChild(a)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],o=[{key:"getConfigElement",value:(i=We().m(function t(){return We().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-climate-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){$e(o,n,r,a,c,"next",t)}function c(t){$e(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Qe(n.prototype,r),o&&Qe(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function rn(t){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rn(t)}function on(t){return function(t){if(Array.isArray(t))return cn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||an(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function an(t,e){if(t){if("string"==typeof t)return cn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cn(t,e):void 0}}function cn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function un(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function ln(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?un(Object(n),!0).forEach(function(e){sn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function sn(t,e,n){return(e=pn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pn(r.key),r)}}function pn(t){var e=function(t){if("object"!=rn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rn(e)?e:e+""}function dn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(dn=function(){return!!t})()}function yn(t){return yn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yn(t)}function hn(t,e){return hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hn(t,e)}var vn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=yn(e),function(t,e){if(e&&("object"==rn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,dn()?Reflect.construct(e,n||[],yn(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=ln(ln({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?on(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加空调":"Add Climate",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("climate.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=on(n._config.entities);e[t]=ln(ln({},e[t]),{},{entity_id:i.value}),n._config=ln(ln({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ln({},n._config)}})),n.render()}),r.appendChild(i);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=on(n._config.entities);e.splice(t,1),n._config=ln(ln({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ln({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=on(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||an(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=ln(ln({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:ln({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&fn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function bn(t){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bn(t)}function mn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return gn(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(gn(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,gn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,gn(f,"constructor",l),gn(l,"constructor",u),u.displayName="GeneratorFunction",gn(l,o,"GeneratorFunction"),gn(f),gn(f,o,"Generator"),gn(f,r,function(){return this}),gn(f,"toString",function(){return"[object Generator]"}),(mn=function(){return{w:i,m:p}})()}function gn(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}gn=function(t,e,n,r){function i(e,n){gn(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},gn(t,e,n,r)}function _n(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function On(t){return function(t){if(Array.isArray(t))return wn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return wn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function jn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function En(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jn(Object(n),!0).forEach(function(e){Pn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Pn(t,e,n){return(e=Cn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cn(r.key),r)}}function Cn(t){var e=function(t){if("object"!=bn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=bn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==bn(e)?e:e+""}function Tn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Tn=function(){return!!t})()}function xn(t){return xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xn(t)}function An(t,e){return An=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},An(t,e)}var kn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=xn(e),function(t,e){if(e&&("object"==bn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Tn()?Reflect.construct(e,n||[],xn(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&An(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=En(En({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?On(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_cover.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass&&this._config){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle("zh"===this._language?"窗帘控制":"Cover Control"),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",this._config.entities.length>0?this._config.entities.forEach(function(e){var r,o=(null===(r=t._hass.states[e.entity_id])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||e.entity_id,i=document.createElement("div");i.style.marginBottom="10px",i.innerHTML="<div>".concat(t._translations[t._language].entity,": ").concat(o,"</div>"),n.appendChild(i)}):n.innerHTML="<div>".concat(this._translations[this._language].validEntity,"</div>"),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=mn().m(function t(){return mn().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-cover-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){_n(o,n,r,a,c,"next",t)}function c(t){_n(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Sn(n.prototype,r),o&&Sn(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function Dn(t){return Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dn(t)}function Rn(t){return function(t){if(Array.isArray(t))return In(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ln(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ln(t,e){if(t){if("string"==typeof t)return In(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?In(t,e):void 0}}function In(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Mn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Bn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mn(Object(n),!0).forEach(function(e){Hn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Hn(t,e,n){return(e=Gn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gn(r.key),r)}}function Gn(t){var e=function(t){if("object"!=Dn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Dn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dn(e)?e:e+""}function zn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(zn=function(){return!!t})()}function Nn(t){return Nn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nn(t)}function Wn(t,e){return Wn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wn(t,e)}var Fn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Nn(e),function(t,e){if(e&&("object"==Dn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zn()?Reflect.construct(e,n||[],Nn(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Bn(Bn({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Rn(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加窗帘":"Add Cover",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("cover.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=Rn(n._config.entities);e[t]=Bn(Bn({},e[t]),{},{entity_id:i.value}),n._config=Bn(Bn({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Bn({},n._config)}})),n.render()}),r.appendChild(i);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Rn(n._config.entities);e.splice(t,1),n._config=Bn(Bn({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Bn({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=Rn(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||Ln(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=Bn(Bn({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Bn({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&Un(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function $n(t){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$n(t)}function Vn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return qn(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(qn(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,qn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,qn(f,"constructor",l),qn(l,"constructor",u),u.displayName="GeneratorFunction",qn(l,o,"GeneratorFunction"),qn(f),qn(f,o,"Generator"),qn(f,r,function(){return this}),qn(f,"toString",function(){return"[object Generator]"}),(Vn=function(){return{w:i,m:p}})()}function qn(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}qn=function(t,e,n,r){function i(e,n){qn(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},qn(t,e,n,r)}function Yn(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Kn(t){return function(t){if(Array.isArray(t))return Jn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Jn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Qn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Xn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qn(Object(n),!0).forEach(function(e){Zn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Zn(t,e,n){return(e=er(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,er(r.key),r)}}function er(t){var e=function(t){if("object"!=$n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=$n(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$n(e)?e:e+""}function nr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(nr=function(){return!!t})()}function rr(t){return rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rr(t)}function or(t,e){return or=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},or(t,e)}var ir=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=rr(e),function(t,e){if(e&&("object"==$n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,nr()?Reflect.construct(e,n||[],rr(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&or(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Xn(Xn({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Kn(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_switch.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass&&this._config){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle("zh"===this._language?"开关控制":"Switch Control"),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",this._config.entities.length>0?this._config.entities.forEach(function(e){var r,o=(null===(r=t._hass.states[e.entity_id])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||e.entity_id,i=document.createElement("div");i.style.marginBottom="10px",i.innerHTML="<div>".concat(t._translations[t._language].entity,": ").concat(o,"</div>"),n.appendChild(i)}):n.innerHTML="<div>".concat(this._translations[this._language].validEntity,"</div>"),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=Vn().m(function t(){return Vn().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-switch-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){Yn(o,n,r,a,c,"next",t)}function c(t){Yn(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&tr(n.prototype,r),o&&tr(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function ar(t){return ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ar(t)}function cr(t){return function(t){if(Array.isArray(t))return lr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ur(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ur(t,e){if(t){if("string"==typeof t)return lr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lr(t,e):void 0}}function lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function sr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function fr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?sr(Object(n),!0).forEach(function(e){pr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function pr(t,e,n){return(e=yr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yr(r.key),r)}}function yr(t){var e=function(t){if("object"!=ar(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ar(e)?e:e+""}function hr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(hr=function(){return!!t})()}function vr(t){return vr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vr(t)}function br(t,e){return br=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},br(t,e)}var mr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=vr(e),function(t,e){if(e&&("object"==ar(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,hr()?Reflect.construct(e,n||[],vr(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&br(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=fr(fr({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?cr(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加开关":"Add Switch",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("switch.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=cr(n._config.entities);e[t]=fr(fr({},e[t]),{},{entity_id:i.value}),n._config=fr(fr({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:fr({},n._config)}})),n.render()}),r.appendChild(i);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=cr(n._config.entities);e.splice(t,1),n._config=fr(fr({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:fr({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=cr(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||ur(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=fr(fr({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:fr({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&dr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function gr(t){return gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gr(t)}function _r(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Or(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Or(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Or(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Or(f,"constructor",l),Or(l,"constructor",u),u.displayName="GeneratorFunction",Or(l,o,"GeneratorFunction"),Or(f),Or(f,o,"Generator"),Or(f,r,function(){return this}),Or(f,"toString",function(){return"[object Generator]"}),(_r=function(){return{w:i,m:p}})()}function Or(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Or=function(t,e,n,r){function i(e,n){Or(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},Or(t,e,n,r)}function wr(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function jr(t){return function(t){if(Array.isArray(t))return Er(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Er(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Er(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Er(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Pr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Sr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Pr(Object(n),!0).forEach(function(e){Cr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Cr(t,e,n){return(e=xr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,xr(r.key),r)}}function xr(t){var e=function(t){if("object"!=gr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=gr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gr(e)?e:e+""}function Ar(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ar=function(){return!!t})()}function kr(t){return kr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kr(t)}function Dr(t,e){return Dr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Dr(t,e)}var Rr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=kr(e),function(t,e){if(e&&("object"==gr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ar()?Reflect.construct(e,n||[],kr(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dr(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Sr(Sr({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?jr(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_weather.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass&&this._config){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle("zh"===this._language?"天气控制":"Weather Control"),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",this._config.entities.length>0?this._config.entities.forEach(function(e){var r,o=(null===(r=t._hass.states[e.entity_id])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||e.entity_id,i=document.createElement("div");i.style.marginBottom="10px",i.innerHTML="<div>".concat(t._translations[t._language].entity,": ").concat(o,"</div>"),n.appendChild(i)}):n.innerHTML="<div>".concat(this._translations[this._language].validEntity,"</div>"),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=_r().m(function t(){return _r().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-weather-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){wr(o,n,r,a,c,"next",t)}function c(t){wr(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Tr(n.prototype,r),o&&Tr(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function Lr(t){return Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lr(t)}function Ir(t){return function(t){if(Array.isArray(t))return Br(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Mr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mr(t,e){if(t){if("string"==typeof t)return Br(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Br(t,e):void 0}}function Br(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Hr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ur(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Hr(Object(n),!0).forEach(function(e){Gr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Gr(t,e,n){return(e=Nr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Nr(r.key),r)}}function Nr(t){var e=function(t){if("object"!=Lr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Lr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lr(e)?e:e+""}function Wr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Wr=function(){return!!t})()}function Fr(t){return Fr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fr(t)}function $r(t,e){return $r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$r(t,e)}var Vr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Fr(e),function(t,e){if(e&&("object"==Lr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Wr()?Reflect.construct(e,n||[],Fr(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$r(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Ur(Ur({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Ir(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加天气":"Add Weather",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("weather.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=Ir(n._config.entities);e[t]=Ur(Ur({},e[t]),{},{entity_id:i.value}),n._config=Ur(Ur({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Ur({},n._config)}})),n.render()}),r.appendChild(i);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Ir(n._config.entities);e.splice(t,1),n._config=Ur(Ur({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Ur({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=Ir(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||Mr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=Ur(Ur({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Ur({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&zr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function qr(t){return qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qr(t)}function Yr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Kr(l,"_invoke",function(n,r,o){var i,c,u,l=0,s=o||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,i=s[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw f=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,i),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Kr(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Kr(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Kr(f,"constructor",l),Kr(l,"constructor",u),u.displayName="GeneratorFunction",Kr(l,o,"GeneratorFunction"),Kr(f),Kr(f,o,"Generator"),Kr(f,r,function(){return this}),Kr(f,"toString",function(){return"[object Generator]"}),(Yr=function(){return{w:i,m:p}})()}function Kr(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}Kr=function(t,e,n,r){function i(e,n){Kr(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},Kr(t,e,n,r)}function Jr(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Qr(t){return function(t){if(Array.isArray(t))return Xr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Xr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Zr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function to(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Zr(Object(n),!0).forEach(function(e){eo(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Zr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function eo(t,e,n){return(e=ro(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function no(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ro(r.key),r)}}function ro(t){var e=function(t){if("object"!=qr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=qr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qr(e)?e:e+""}function oo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(oo=function(){return!!t})()}function io(t){return io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},io(t)}function ao(t,e){return ao=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ao(t,e)}var co=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=io(e),function(t,e){if(e&&("object"==qr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oo()?Reflect.construct(e,n||[],io(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ao(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=to(to({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Qr(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_host.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass&&this._config){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle("zh"===this._language?"主机控制":"Host Control"),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",this._config.entities.length>0?this._config.entities.forEach(function(e){var r,o=(null===(r=t._hass.states[e.entity_id])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||e.entity_id,i=document.createElement("div");i.style.marginBottom="10px",i.innerHTML="<div>".concat(t._translations[t._language].entity,": ").concat(o,"</div>"),n.appendChild(i)}):n.innerHTML="<div>".concat(this._translations[this._language].validEntity,"</div>"),e.appendChild(n),this.appendChild(e)}}}],o=[{key:"getConfigElement",value:(i=Yr().m(function t(){return Yr().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-host-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var o=i.apply(t,e);function a(t){Jr(o,n,r,a,c,"next",t)}function c(t){Jr(o,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&no(n.prototype,r),o&&no(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(u);function uo(t){return uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uo(t)}function lo(t){return function(t){if(Array.isArray(t))return fo(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||so(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function so(t,e){if(t){if("string"==typeof t)return fo(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fo(t,e):void 0}}function fo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function po(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function yo(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?po(Object(n),!0).forEach(function(e){ho(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):po(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ho(t,e,n){return(e=bo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bo(r.key),r)}}function bo(t){var e=function(t){if("object"!=uo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=uo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==uo(e)?e:e+""}function mo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(mo=function(){return!!t})()}function go(t){return go=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},go(t)}function _o(t,e){return _o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_o(t,e)}var Oo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=go(e),function(t,e){if(e&&("object"==uo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,mo()?Reflect.construct(e,n||[],go(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_o(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=yo(yo({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?lo(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var o=t._createEntityRow(r,e);n.appendChild(o)});var r=this._createButton("zh"===this._language?"添加主机":"Add Host",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var o=document.createElement("span");o.innerText=this._translations[this._language].selectEntity+": ",o.style.width="100px",r.appendChild(o);var i=document.createElement("select");i.style.width="250px",i.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("remote.")){var r,o=document.createElement("option");o.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;o.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(o.selected=!0),i.appendChild(o)}}),i.addEventListener("change",function(){var e=lo(n._config.entities);e[t]=yo(yo({},e[t]),{},{entity_id:i.value}),n._config=yo(yo({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:yo({},n._config)}})),n.render()}),r.appendChild(i);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=lo(n._config.entities);e.splice(t,1),n._config=yo(yo({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:yo({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var o=parseInt(r.target.dataset.index);if(!isNaN(o)&&n!==o){var i=lo(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||so(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i.splice(n,1),1)[0];i.splice(o,0,a),e._config=yo(yo({},e._config),{},{entities:i}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:yo({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&vo(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);customElements.define("aiks-tv-card",P),customElements.define("aiks-tv-card-editor",B),customElements.define("aiks-light-card",X),customElements.define("aiks-light-card-editor",ft),customElements.define("aiks-fan-card",St),customElements.define("aiks-fan-card-editor",Ut),customElements.define("aiks-scene-card",te),customElements.define("aiks-scene-card-editor",de),customElements.define("aiks-media-player-card",Te),customElements.define("aiks-media-player-card-editor",ze),customElements.define("aiks-climate-card",nn),customElements.define("aiks-climate-card-editor",vn),customElements.define("aiks-cover-card",kn),customElements.define("aiks-cover-card-editor",Fn),customElements.define("aiks-switch-card",ir),customElements.define("aiks-switch-card-editor",mr),customElements.define("aiks-weather-card",Rr),customElements.define("aiks-weather-card-editor",Vr),customElements.define("aiks-host-card",co),customElements.define("aiks-host-card-editor",Oo),window.customCards=window.customCards||[],window.customCards.push({type:"aiks-tv-card",name:navigator.language.startsWith("zh")?"电视(ROS)":"TV(ROS)",description:navigator.language.startsWith("zh")?"电视卡片":"TV Card",preview:!0},{type:"aiks-light-card",name:navigator.language.startsWith("zh")?"灯光(ROS)":"Light(ROS)",description:navigator.language.startsWith("zh")?"灯光卡片":"Light Card",preview:!0},{type:"aiks-fan-card",name:navigator.language.startsWith("zh")?"风扇(ROS)":"Fan(ROS)",description:navigator.language.startsWith("zh")?"风扇卡片":"Fan Card",preview:!0},{type:"aiks-scene-card",name:navigator.language.startsWith("zh")?"场景(ROS)":"Scene(ROS)",description:navigator.language.startsWith("zh")?"场景卡片":"Scene Card",preview:!0},{type:"aiks-media-player-card",name:navigator.language.startsWith("zh")?"媒体播放器(ROS)":"Media Player(ROS)",description:navigator.language.startsWith("zh")?"媒体播放器卡片":"Media Player Card",preview:!0},{type:"aiks-climate-card",name:navigator.language.startsWith("zh")?"空调(ROS)":"AC(ROS)",description:navigator.language.startsWith("zh")?"空调卡片":"AC Card",preview:!0},{type:"aiks-cover-card",name:navigator.language.startsWith("zh")?"窗帘(ROS)":"Cover(ROS)",description:navigator.language.startsWith("zh")?"窗帘卡片":"Cover Card",preview:!0},{type:"aiks-switch-card",name:navigator.language.startsWith("zh")?"开关(ROS)":"Switch(ROS)",description:navigator.language.startsWith("zh")?"开关卡片":"Switch Card",preview:!0},{type:"aiks-weather-card",name:navigator.language.startsWith("zh")?"天气(ROS)":"Weather(ROS)",description:navigator.language.startsWith("zh")?"天气卡片":"Weather Card",preview:!0},{type:"aiks-host-card",name:navigator.language.startsWith("zh")?"主机(ROS)":"Host(ROS)",description:navigator.language.startsWith("zh")?"主机卡片":"Host Card",preview:!0}),console.log("✅ Aiks Custom Cards loaded successfully!")})();
//# sourceMappingURL=RosCard.js.map