/*! For license information please see RosCard.js.LICENSE.txt */
(()=>{"use strict";var t={zh:{cardTitle:function(t){return"".concat(t||"未命名设备"," 卡片")},controlPanelTitle:"发送控制命令",sendButton:"发送",testButton:"测试",nameLabel:"设备名称: ",selectEntity:"请选择实体",selectCommand:"请选择命令",selectOption:"请选择选项",enterCommand:"请输入命令值...",clearButton:"清空",validEntity:"请选择有效实体",stateOn:"开",stateOff:"关",defaultIconPath:"/local/community/RosCard/icon_img/states_device_light_on_icon.png",entity:"实体",executionModes:{immediate:"立即执行",delayed:"延迟执行",popup:"弹窗询问"},independentDisplay:"是否独立显示",yes:"是",no:"否"},en:{cardTitle:function(t){return"".concat(t||"Unnamed Device"," Card")},controlPanelTitle:"Send Control Commands",sendButton:"Send",testButton:"Test",nameLabel:"Device Name: ",selectEntity:"Please select an entity",selectCommand:"Please select a command",selectOption:"Please select an option",enterCommand:"Enter command value...",clearButton:"Clear",validEntity:"Please select a valid entity",stateOn:"On",stateOff:"Off",defaultIconPath:"/local/community/RosCard/icon_img/states_device_light_on_icon.png",entity:"Entity",executionModes:{immediate:"Immediate",delayed:"Delayed",popup:"Popup Ask"},independentDisplay:"Show independently",yes:"Yes",no:"No"}};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}function i(t){var e="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(o())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var i=new(t.bind.apply(t,r));return n&&a(i,n.prototype),i}(t,arguments,c(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),a(n,t)},i(t)}function o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(o=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function c(t){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},c(t)}var u=function(r){function i(){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=function(t,n,r){return n=c(n),function(t,n){if(n&&("object"==e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,o()?Reflect.construct(n,r||[],c(t).constructor):n.apply(t,r))}(this,i)).firstRender=!0,n._language=navigator.language.startsWith("zh")?"zh":"en",n._translations=t,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(i,r),u=i,(l=[{key:"_createButton",value:function(t,e){var n=document.createElement("button");return n.innerText=t,n.style.margin="4px",n.style.padding="8px 12px",n.style.cursor="pointer",n.style.borderRadius="4px",n.onclick=e.bind(this),n}},{key:"_createIcon",value:function(t){var e=document.createElement("img");return e.src=t||this._translations[this._language].defaultIconPath,e.style.position="absolute",e.style.top="50px",e.style.right="30px",e.style.width="60px",e.style.height="60px",e}},{key:"_t",value:function(t){var e;return(null===(e=this._translations[this._language])||void 0===e?void 0:e[t])||""}}])&&n(u.prototype,l),Object.defineProperty(u,"prototype",{writable:!1}),u;var u,l}(i(HTMLElement));function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return f(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(f(e={},r,function(){return this}),e),d=l.prototype=c.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,f(t,i,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=l,f(d,"constructor",l),f(l,"constructor",u),u.displayName="GeneratorFunction",f(l,i,"GeneratorFunction"),f(d),f(d,i,"Generator"),f(d,r,function(){return this}),f(d,"toString",function(){return"[object Generator]"}),(s=function(){return{w:o,m:y}})()}function f(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}f=function(t,e,n,r){function o(e,n){f(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},f(t,e,n,r)}function p(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function d(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){if(t){if("string"==typeof t)return h(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach(function(e){g(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function g(t,e,n){return(e=_(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_(r.key),r)}}function _(t){var e=function(t){if("object"!=l(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==l(e)?e:e+""}function O(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(O=function(){return!!t})()}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}var E=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=w(e),function(t,e){if(e&&("object"==l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,O()?Reflect.construct(e,n||[],w(t).constructor):e.apply(t,n))}(this,e))._translations={zh:b(b({},t._translations.zh),{},{mediaCommands:[{label:"播放",value:"media_play"},{label:"暂停",value:"media_pause"},{label:"音量增加",value:"volume_up"},{label:"音量减少",value:"volume_down"},{label:"静音",value:"volume_mute_true"},{label:"取消静音",value:"volume_mute_false"}]}),en:b(b({},t._translations.en),{},{mediaCommands:[{label:"Play",value:"media_play"},{label:"Pause",value:"media_pause"},{label:"Volume Up",value:"volume_up"},{label:"Volume Down",value:"volume_down"},{label:"Mute",value:"volume_mute_true"},{label:"Unmute",value:"volume_mute_false"}]})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=b(b({},t),{},{tv_name:t.tv_name||("zh"===this._language?"未命名电视":"Unnamed TV"),entities:Array.isArray(null==t?void 0:t.entities)?d(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_tv.png",tv_type:t.tv_type||"android_tv"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.tv_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){"media_player"===e.type&&e.commands&&Object.entries(e.commands).forEach(function(r){var i=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||y(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(r,2),o=i[0],a=i[1],c=document.createElement("div");c.style.marginBottom="8px",c.innerHTML="<span>".concat(e.entity_id,": ").concat(o,"</span>");var u=t._createButton(t._translations[t._language].sendButton,function(){"volume_mute"===a?t._hass.callService(e.type,a,{entity_id:e.entity_id,is_volume_muted:o.includes("静音")||o.includes("Mute")}):t._hass.callService(e.type,a,{entity_id:e.entity_id})});c.appendChild(u),n.appendChild(c)})}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=s().m(function t(){return s().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-tv-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){p(i,n,r,a,c,"next",t)}function c(t){p(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{type:"custom:aiks-tv-card",id:"",tv_type:"android_tv",tv_name:"zh"==(navigator.language.startsWith("zh")?"zh":"en")?"未命名电视":"Unnamed TV",media_play_entity:"",entities:[]}}}],r&&m(n.prototype,r),i&&m(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function P(t){return function(t){if(Array.isArray(t))return C(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return C(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function x(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach(function(e){L(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,I(r.key),r)}}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(k=function(){return!!t})()}function D(t){return D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},D(t)}function R(t,e){return R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},R(t,e)}function L(t,e,n){return(e=I(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I(t){var e=function(t){if("object"!=S(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==S(e)?e:e+""}var M=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=D(e),function(t,e){if(e&&("object"==S(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,n||[],D(t).constructor):e.apply(t,n))}(this,e))._translations=x(x({},t._translations),{},{zh:x(x({},t._translations.zh),{},{mediaCommands:[{label:"播放",value:"media_play"},{label:"暂停",value:"media_pause"},{label:"音量增加",value:"volume_up"},{label:"音量减少",value:"volume_down"},{label:"静音",value:"volume_mute_true"},{label:"取消静音",value:"volume_mute_false"}]}),en:x(x({},t._translations.en),{},{mediaCommands:[{label:"Play",value:"media_play"},{label:"Pause",value:"media_pause"},{label:"Volume Up",value:"volume_up"},{label:"Volume Down",value:"volume_down"},{label:"Mute",value:"volume_mute_true"},{label:"Unmute",value:"volume_mute_false"}]})}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R(t,e)}(e,t),n=e,r=[{key:"generateUUID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})}},{key:"setConfig",value:function(t){var e=x({},t);e.id||(e.id=this.generateUUID()),this._config={type:e.type||"custom:aiks-tv-card",id:e.id,tv_type:e.tv_type||"android_tv",tv_name:e.tv_name||("zh"===this._language?"未命名电视":"Unnamed TV"),media_play_entity:e.media_play_entity||"",entities:Array.isArray(e.entities)?P(e.entities):[]},this.dispatchEvent(new CustomEvent("config-changed",{detail:{config:x({},this._config)}})),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.style.marginBottom="10px",n.style.display="flex",n.style.alignItems="center";var r=document.createElement("span");r.innerText="zh"===this._language?"设备类型: ":"Device Type: ",r.style.width="100px",n.appendChild(r);var i=document.createElement("select");if(i.style.width="120px",[{value:"apple_tv",label:(this._language,"Apple TV")},{value:"android_tv",label:"zh"===this._language?"安卓电视":"Android TV"}].forEach(function(e){var n=document.createElement("option");n.value=e.value,n.text=e.label,t._config.tv_type===e.value&&(n.selected=!0),i.appendChild(n)}),i.addEventListener("change",function(){t._config.tv_type=i.value,"android_tv"===i.value&&(t._config.media_play_entity=""),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:x({},t._config)}})),t.render()}),n.appendChild(i),e.appendChild(n),"apple_tv"===this._config.tv_type){var o=document.createElement("div");o.style.marginBottom="10px",o.style.display="flex",o.style.alignItems="center";var a=document.createElement("span");a.innerText="zh"===this._language?"播放实体: ":"Media Player: ",a.style.width="100px",o.appendChild(a);var c=document.createElement("select");c.style.width="200px",c.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(e){if(e.startsWith("media_player.")){var n,r=document.createElement("option");r.value=e,r.text=(null===(n=t._hass.states[e])||void 0===n||null===(n=n.attributes)||void 0===n?void 0:n.friendly_name)||e,e===t._config.media_play_entity&&(r.selected=!0),c.appendChild(r)}}),c.addEventListener("change",function(){t._config.media_play_entity=c.value,t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:x({},t._config)}}))}),o.appendChild(c),e.appendChild(o)}var u=document.createElement("div");u.style.marginBottom="10px",u.style.display="flex",u.style.alignItems="center";var l=document.createElement("span");l.innerText=this._translations[this._language].nameLabel,l.style.width="100px",u.appendChild(l);var s=document.createElement("input");s.type="text",s.value=this._config.tv_name,s.style.width="200px",s.addEventListener("blur",function(){t._config.tv_name=s.value,t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:x({},t._config)}}))}),u.appendChild(s),e.appendChild(u);var f=document.createElement("div");f.id="entityContainer",this._config.entities=["POWER","UP","DOWN","LEFT","RIGHT","ENTER","BACK","PLAY","PAUSE","VOLUME_UP","VOLUME_DOWN","MUTE","UN_MUTE","SETTINGS","HOME","MENU"].map(function(e,n){return t._config.entities[n]||{key:e,type:"",entity_id:"",value:""}}),this._config.entities.forEach(function(e,n){f.appendChild(t._createEntityRow(n,e,t._hass))}),e.appendChild(f),this.appendChild(e)}}},{key:"_showToast",value:function(t){try{this.dispatchEvent(new CustomEvent("show-toast",{detail:{message:t}}))}catch(e){console.warn(t)}}},{key:"_sendTest",value:function(t,e){var n,r=this._hass;if(r){var i=(null==t?void 0:t.entity_id)||"",o=i?i.split(".")[0]:(null==t?void 0:t.type)||"",a=(null!==(n=null!=e?e:null==t?void 0:t.value)&&void 0!==n?n:"").toString().trim();if(i&&o)if(a||"media_player"===o)if("remote"!==o)if("media_player"!==o)"select"!==o?this._showToast("不支持的类型：".concat(o)):r.callService("select","select_option",{entity_id:i,option:a});else if("volume_mute_true"===a||"volume_mute_false"===a)r.callService("media_player","volume_mute",{entity_id:i,is_volume_muted:a.endsWith("_true")});else if(a.startsWith("volume_set_")){var c=parseFloat(a.split("_").pop());Number.isNaN(c)?this._showToast("音量格式应为 volume_set_0.0~1.0"):r.callService("media_player","volume_set",{entity_id:i,volume_level:Math.max(0,Math.min(1,c))})}else r.callService("media_player",a||"media_play",{entity_id:i});else r.callService("remote","send_command",{entity_id:i,command:a});else this._showToast("请先填写命令/选项");else this._showToast("请先选择实体")}else this._showToast("hass 未就绪")}},{key:"_createEntityRow",value:function(t,n,r){var i=this,o=document.createElement("div");o.style.marginBottom="10px",o.style.display="flex",o.style.alignItems="center";var a=document.createElement("span");a.innerText="".concat(n.key,": "),a.style.width="100px",o.appendChild(a);var c=document.createElement("select");c.style.width="200px",c.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(r.states).forEach(function(t){if(t.startsWith("media_player.")||t.startsWith("remote.")||t.startsWith("select.")){var e,i=document.createElement("option");i.value=t,i.text=(null===(e=r.states[t])||void 0===e||null===(e=e.attributes)||void 0===e?void 0:e.friendly_name)||t,t===n.entity_id&&(i.selected=!0),c.appendChild(i)}}),o.appendChild(c);var u=document.createElement("div");u.style.marginLeft="10px",o.appendChild(u);var l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=i._config.entities.map(function(n,r){return r===t?x(x({},n),e):n});i._config=x(x({},i._config),{},{entities:n}),i.dispatchEvent(new CustomEvent("config-changed",{detail:{config:i._config},bubbles:!0,composed:!0}))},s=function(){var t;u.innerHTML="";var o=c.value,a=o?o.split(".")[0]:"",s=null;if("media_player"===a){var f=document.createElement("select");f.style.width="200px",f.innerHTML='<option value="">'.concat(i._translations[i._language].selectCommand,"</option>"),i._translations[i._language].mediaCommands.forEach(function(t){var e=document.createElement("option");e.value=t.value,e.text=t.label,t.value===n.value&&(e.selected=!0),f.appendChild(e)}),f.addEventListener("change",function(){return l({value:f.value})}),u.appendChild(f),s=f}else if("select"===a&&null!==(t=r.states[o])&&void 0!==t&&null!==(t=t.attributes)&&void 0!==t&&t.options){var p=document.createElement("select");p.style.width="200px",p.innerHTML='<option value="">'.concat(i._translations[i._language].selectOption,"</option>"),r.states[o].attributes.options.forEach(function(t){var e=document.createElement("option");e.value=t,e.text=t,t===n.value&&(e.selected=!0),p.appendChild(e)}),p.addEventListener("change",function(){return l({value:p.value})}),u.appendChild(p),s=p}else if("remote"===a){var d=document.createElement("input");if(d.type="text",n.value)d.value=n.value;else{var y,h=i._config.tv_type||"android_tv",v=(null===(y=e.REMOTE_DEFAULTS)||void 0===y||null===(y=y[h])||void 0===y?void 0:y[n.key])||"";d.value=v,l({value:v})}d.style.width="200px",d.placeholder=i._translations[i._language].enterCommand,d.addEventListener("input",function(){return l({value:d.value})}),u.appendChild(d);var b=i._createButton("zh"===i._language?"恢复默认":"Reset Default",function(){var t,r=i._config.tv_type||"android_tv",o=(null===(t=e.REMOTE_DEFAULTS)||void 0===t||null===(t=t[r])||void 0===t?void 0:t[n.key])||"";d.value=o,l({value:o})});u.appendChild(b);var g=i._createButton(i._translations[i._language].testButton,function(){return i._sendTest({key:n.key,type:a,entity_id:c.value,value:d.value},d.value)});u.appendChild(g)}else u.innerHTML="<span>".concat(i._translations[i._language].validEntity,"</span>");if(s){var m=i._createButton(i._translations[i._language].testButton,function(){return i._sendTest({key:n.key,type:a,entity_id:c.value,value:s.value},s.value)});u.appendChild(m)}};return c.addEventListener("change",function(){var t=c.value||"",r=t?t.split(".")[0]:"",o={entity_id:t,type:r};if("remote"===r){var a,u=i._config.tv_type||"android_tv";o.value=(null===(a=e.REMOTE_DEFAULTS)||void 0===a||null===(a=a[u])||void 0===a?void 0:a[n.key])||""}l(o),s()}),n.entity_id&&(c.value=n.entity_id,s()),o}}],r&&A(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function U(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return z(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(z(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,z(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,z(f,"constructor",l),z(l,"constructor",u),u.displayName="GeneratorFunction",z(l,i,"GeneratorFunction"),z(f),z(f,i,"Generator"),z(f,r,function(){return this}),z(f,"toString",function(){return"[object Generator]"}),(U=function(){return{w:o,m:p}})()}function z(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}z=function(t,e,n,r){function o(e,n){z(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},z(t,e,n,r)}function H(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function G(t){return function(t){if(Array.isArray(t))return W(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return W(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach(function(e){$(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function $(t,e,n){return(e=q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,q(r.key),r)}}function q(t){var e=function(t){if("object"!=B(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==B(e)?e:e+""}function Y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Y=function(){return!!t})()}function K(t){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},K(t)}function J(t,e){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},J(t,e)}L(M,"REMOTE_DEFAULTS",{android_tv:{POWER:"POWER",UP:"UP",DOWN:"DOWN",LEFT:"LEFT",RIGHT:"RIGHT",ENTER:"ENTER",BACK:"BACK",PLAY:"PLAY",PAUSE:"PAUSE",VOLUME_UP:"VOLUME_UP",VOLUME_DOWN:"VOLUME_DOWN",MUTE:"MUTE",UN_MUTE:"UNMUTE",SETTINGS:"SETTINGS",HOME:"HOME",MENU:"MENU"},apple_tv:{POWER:"suspend",UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",ENTER:"select",BACK:"menu",PLAY:"play",PAUSE:"pause",VOLUME_UP:"volume_up",VOLUME_DOWN:"volume_down",MUTE:"mute",UN_MUTE:"",SETTINGS:"wakeup",HOME:"home",MENU:"menu"}});var Q=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=K(e),function(t,e){if(e&&("object"==B(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Y()?Reflect.construct(e,n||[],K(t).constructor):e.apply(t,n))}(this,e))._translations={zh:F(F({},t._translations.zh),{},{brightness:"亮度",color:"颜色",colorTemp:"色温",scene:"场景"}),en:F(F({},t._translations.en),{},{brightness:"Brightness",color:"Color",colorTemp:"Color Temp",scene:"Scene"})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=F(F({},t),{},{light_name:t.light_name||("zh"===this._language?"未命名灯光":"Unnamed Light"),entities:Array.isArray(null==t?void 0:t.entities)?G(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_light.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.light_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("light.")){var r,i=document.createElement("div");i.style.marginBottom="12px",i.style.padding="8px",i.style.border="1px solid #ddd",i.style.borderRadius="4px";var o=t._hass.states[e.entity_id],a="on"===(null==o?void 0:o.state)?t._translations[t._language].stateOn:t._translations[t._language].stateOff;i.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong> - ").concat(a,"</div>");var c=t._createButton("on"===(null==o?void 0:o.state)?"Off":"On",function(){var n="on"===(null==o?void 0:o.state)?"turn_off":"turn_on";t._hass.callService("light",n,{entity_id:e.entity_id})});if(i.appendChild(c),void 0!==(null==o||null===(r=o.attributes)||void 0===r?void 0:r.brightness)){var u=Math.round(o.attributes.brightness/255*100),l=document.createElement("input");l.type="range",l.min="0",l.max="100",l.value=u,l.style.width="100%",l.style.marginTop="8px",l.addEventListener("change",function(n){var r=Math.round(n.target.value/100*255);t._hass.callService("light","turn_on",{entity_id:e.entity_id,brightness:r})}),i.appendChild(l)}n.appendChild(i)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=U().m(function t(){return U().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-light-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){H(i,n,r,a,c,"next",t)}function c(t){H(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&V(n.prototype,r),i&&V(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function Z(t){return function(t){if(Array.isArray(t))return et(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||tt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t,e){if(t){if("string"==typeof t)return et(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach(function(e){it(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function it(t,e,n){return(e=at(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ot(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,at(r.key),r)}}function at(t){var e=function(t){if("object"!=X(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==X(e)?e:e+""}function ct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ct=function(){return!!t})()}function ut(t){return ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ut(t)}function lt(t,e){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lt(t,e)}var st=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=ut(e),function(t,e){if(e&&("object"==X(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ct()?Reflect.construct(e,n||[],ut(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lt(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=rt(rt({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Z(t.entities):[]}),this._config.entities=this._config.entities.map(function(t){return rt(rt({},t),{},{independent_display:!0===t.independent_display})}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加设备":"Add Device",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("light.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=Z(n._config.entities);e[t]=rt(rt({},e[t]),{},{entity_id:o.value}),n._config=rt(rt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:rt({},n._config)}})),n.render()}),r.appendChild(o);var a=document.createElement("label");a.style.marginLeft="10px",a.style.display="inline-flex",a.style.alignItems="center",a.style.gap="6px";var c=document.createElement("input");c.type="checkbox",c.checked=!!e.independent_display;var u=document.createElement("span");u.textContent=this._translations[this._language].independentDisplay,a.appendChild(c),a.appendChild(u),r.appendChild(a),c.addEventListener("change",function(){var e=Z(n._config.entities);e[t]=rt(rt({},e[t]),{},{independent_display:c.checked}),n._config=rt(rt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:rt({},n._config)}}))});var l=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Z(n._config.entities);e.splice(t,1),n._config=rt(rt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:rt({},n._config)}})),n.render()});return r.appendChild(l),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=Z(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||tt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=rt(rt({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:rt({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&ot(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function pt(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return dt(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(dt(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,dt(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,dt(f,"constructor",l),dt(l,"constructor",u),u.displayName="GeneratorFunction",dt(l,i,"GeneratorFunction"),dt(f),dt(f,i,"Generator"),dt(f,r,function(){return this}),dt(f,"toString",function(){return"[object Generator]"}),(pt=function(){return{w:o,m:p}})()}function dt(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}dt=function(t,e,n,r){function o(e,n){dt(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},dt(t,e,n,r)}function yt(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function ht(t){return function(t){if(Array.isArray(t))return vt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return vt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bt(Object(n),!0).forEach(function(e){mt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function mt(t,e,n){return(e=Ot(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ot(r.key),r)}}function Ot(t){var e=function(t){if("object"!=ft(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ft(e)?e:e+""}function wt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(wt=function(){return!!t})()}function jt(t){return jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jt(t)}function Et(t,e){return Et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Et(t,e)}var St=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=jt(e),function(t,e){if(e&&("object"==ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,wt()?Reflect.construct(e,n||[],jt(t).constructor):e.apply(t,n))}(this,e))._translations={zh:gt(gt({},t._translations.zh),{},{speed:"速度",oscillate:"摆动",direction:"方向"}),en:gt(gt({},t._translations.en),{},{speed:"Speed",oscillate:"Oscillate",direction:"Direction"})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Et(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=gt(gt({},t),{},{fan_name:t.fan_name||("zh"===this._language?"未命名风扇":"Unnamed Fan"),entities:Array.isArray(null==t?void 0:t.entities)?ht(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_fan.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.fan_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("fan.")){var r,i,o=document.createElement("div");o.style.marginBottom="12px",o.style.padding="8px",o.style.border="1px solid #ddd",o.style.borderRadius="4px";var a=t._hass.states[e.entity_id],c="on"===(null==a?void 0:a.state)?t._translations[t._language].stateOn:t._translations[t._language].stateOff;o.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong> - ").concat(c,"</div>");var u=t._createButton("on"===(null==a?void 0:a.state)?"Off":"On",function(){var n="on"===(null==a?void 0:a.state)?"turn_off":"turn_on";t._hass.callService("fan",n,{entity_id:e.entity_id})});if(o.appendChild(u),void 0!==(null==a||null===(r=a.attributes)||void 0===r?void 0:r.percentage)){var l=document.createElement("input");l.type="range",l.min="0",l.max="100",l.value=a.attributes.percentage||0,l.style.width="100%",l.style.marginTop="8px",l.addEventListener("change",function(n){t._hass.callService("fan","set_percentage",{entity_id:e.entity_id,percentage:parseInt(n.target.value)})}),o.appendChild(l)}if(void 0!==(null==a||null===(i=a.attributes)||void 0===i?void 0:i.oscillating)){var s=t._createButton(a.attributes.oscillating?"Stop Oscillate":"Start Oscillate",function(){t._hass.callService("fan","oscillate",{entity_id:e.entity_id,oscillating:!a.attributes.oscillating})});o.appendChild(s)}n.appendChild(o)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=pt().m(function t(){return pt().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-fan-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){yt(i,n,r,a,c,"next",t)}function c(t){yt(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&_t(n.prototype,r),i&&_t(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function Ct(t){return function(t){if(Array.isArray(t))return xt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Tt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tt(t,e){if(t){if("string"==typeof t)return xt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xt(t,e):void 0}}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function At(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?At(Object(n),!0).forEach(function(e){Dt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Dt(t,e,n){return(e=Lt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Lt(r.key),r)}}function Lt(t){var e=function(t){if("object"!=Pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pt(e)?e:e+""}function It(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(It=function(){return!!t})()}function Mt(t){return Mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mt(t)}function Bt(t,e){return Bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Bt(t,e)}var Ut=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Mt(e),function(t,e){if(e&&("object"==Pt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,It()?Reflect.construct(e,n||[],Mt(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bt(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=kt(kt({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Ct(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加设备":"Add Device",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("fan.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=Ct(n._config.entities);e[t]=kt(kt({},e[t]),{},{entity_id:o.value}),n._config=kt(kt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:kt({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Ct(n._config.entities);e.splice(t,1),n._config=kt(kt({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:kt({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=Ct(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||Tt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=kt(kt({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:kt({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&Rt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function Ht(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Gt(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Gt(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Gt(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Gt(f,"constructor",l),Gt(l,"constructor",u),u.displayName="GeneratorFunction",Gt(l,i,"GeneratorFunction"),Gt(f),Gt(f,i,"Generator"),Gt(f,r,function(){return this}),Gt(f,"toString",function(){return"[object Generator]"}),(Ht=function(){return{w:o,m:p}})()}function Gt(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Gt=function(t,e,n,r){function o(e,n){Gt(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},Gt(t,e,n,r)}function Wt(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function Nt(t){return function(t){if(Array.isArray(t))return Ft(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ft(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ft(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function $t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$t(Object(n),!0).forEach(function(e){qt(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function qt(t,e,n){return(e=Kt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Kt(r.key),r)}}function Kt(t){var e=function(t){if("object"!=zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=zt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(e)?e:e+""}function Jt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Jt=function(){return!!t})()}function Qt(t){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qt(t)}function Xt(t,e){return Xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xt(t,e)}var Zt=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Qt(e),function(t,e){if(e&&("object"==zt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Jt()?Reflect.construct(e,n||[],Qt(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xt(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Vt(Vt({},t),{},{scene_name:t.scene_name||("zh"===this._language?"未命名场景":"Unnamed Scene"),entities:Array.isArray(null==t?void 0:t.entities)?Nt(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_scene.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.scene_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("scene.")){var r=document.createElement("div");r.style.marginBottom="8px";var i=t._createButton(e.scene_name||e.entity_id,function(){t._hass.callService("scene","turn_on",{entity_id:e.entity_id})});i.style.width="100%",i.style.padding="12px",r.appendChild(i),n.appendChild(r)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=Ht().m(function t(){return Ht().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-scene-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){Wt(i,n,r,a,c,"next",t)}function c(t){Wt(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Yt(n.prototype,r),i&&Yt(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function te(t){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(t)}function ee(t){return function(t){if(Array.isArray(t))return re(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||ne(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(t,e){if(t){if("string"==typeof t)return re(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(t,e):void 0}}function re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function ie(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ie(Object(n),!0).forEach(function(e){ae(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ae(t,e,n){return(e=ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ce(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ue(r.key),r)}}function ue(t){var e=function(t){if("object"!=te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==te(e)?e:e+""}function le(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(le=function(){return!!t})()}function se(t){return se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},se(t)}function fe(t,e){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fe(t,e)}var pe=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=se(e),function(t,e){if(e&&("object"==te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,le()?Reflect.construct(e,n||[],se(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fe(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=oe(oe({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?ee(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加场景":"Add Scene",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("scene.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=ee(n._config.entities);e[t]=oe(oe({},e[t]),{},{entity_id:o.value}),n._config=oe(oe({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:oe({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=ee(n._config.entities);e.splice(t,1),n._config=oe(oe({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:oe({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=ee(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||ne(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=oe(oe({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:oe({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&ce(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function de(t){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},de(t)}function ye(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return he(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(he(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,he(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,he(f,"constructor",l),he(l,"constructor",u),u.displayName="GeneratorFunction",he(l,i,"GeneratorFunction"),he(f),he(f,i,"Generator"),he(f,r,function(){return this}),he(f,"toString",function(){return"[object Generator]"}),(ye=function(){return{w:o,m:p}})()}function he(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}he=function(t,e,n,r){function o(e,n){he(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},he(t,e,n,r)}function ve(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function be(t){return function(t){if(Array.isArray(t))return ge(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ge(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ge(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function me(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function _e(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?me(Object(n),!0).forEach(function(e){Oe(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Oe(t,e,n){return(e=je(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,je(r.key),r)}}function je(t){var e=function(t){if("object"!=de(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=de(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==de(e)?e:e+""}function Ee(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ee=function(){return!!t})()}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Se(t)}function Pe(t,e){return Pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pe(t,e)}var Ce=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Se(e),function(t,e){if(e&&("object"==de(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ee()?Reflect.construct(e,n||[],Se(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pe(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=_e(_e({},t),{},{media_name:t.media_name||("zh"===this._language?"未命名播放器":"Unnamed Player"),entities:Array.isArray(null==t?void 0:t.entities)?be(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_media_play1.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.media_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("media_player.")){var r=t._hass.states[e.entity_id],i=document.createElement("div");i.style.marginBottom="12px",i.style.padding="8px",i.style.border="1px solid #ddd",i.style.borderRadius="4px",i.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong> - ").concat((null==r?void 0:r.state)||"unknown","</div>");var o=t._createButton("Play",function(){t._hass.callService("media_player","media_play",{entity_id:e.entity_id})}),a=t._createButton("Pause",function(){t._hass.callService("media_player","media_pause",{entity_id:e.entity_id})}),c=t._createButton("Stop",function(){t._hass.callService("media_player","media_stop",{entity_id:e.entity_id})});i.appendChild(o),i.appendChild(a),i.appendChild(c),n.appendChild(i)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=ye().m(function t(){return ye().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-media-player-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){ve(i,n,r,a,c,"next",t)}function c(t){ve(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&we(n.prototype,r),i&&we(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function xe(t){return function(t){if(Array.isArray(t))return ke(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ae(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(t,e){if(t){if("string"==typeof t)return ke(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ke(t,e):void 0}}function ke(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function De(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?De(Object(n),!0).forEach(function(e){Le(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Le(t,e,n){return(e=Me(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Me(r.key),r)}}function Me(t){var e=function(t){if("object"!=Te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Te(e)?e:e+""}function Be(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Be=function(){return!!t})()}function Ue(t){return Ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ue(t)}function ze(t,e){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ze(t,e)}var He=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Ue(e),function(t,e){if(e&&("object"==Te(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Be()?Reflect.construct(e,n||[],Ue(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ze(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Re(Re({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?xe(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加播放器":"Add Media Player",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("media_player.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=xe(n._config.entities);e[t]=Re(Re({},e[t]),{},{entity_id:o.value}),n._config=Re(Re({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Re({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=xe(n._config.entities);e.splice(t,1),n._config=Re(Re({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Re({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=xe(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||Ae(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=Re(Re({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Re({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&Ie(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Ge(t){return Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ge(t)}function We(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Ne(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Ne(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Ne(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Ne(f,"constructor",l),Ne(l,"constructor",u),u.displayName="GeneratorFunction",Ne(l,i,"GeneratorFunction"),Ne(f),Ne(f,i,"Generator"),Ne(f,r,function(){return this}),Ne(f,"toString",function(){return"[object Generator]"}),(We=function(){return{w:o,m:p}})()}function Ne(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Ne=function(t,e,n,r){function o(e,n){Ne(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},Ne(t,e,n,r)}function Fe(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function $e(t){return function(t){if(Array.isArray(t))return Ve(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ve(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function qe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ye(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qe(Object(n),!0).forEach(function(e){Ke(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Ke(t,e,n){return(e=Qe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Je(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qe(r.key),r)}}function Qe(t){var e=function(t){if("object"!=Ge(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ge(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ge(e)?e:e+""}function Xe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Xe=function(){return!!t})()}function Ze(t){return Ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ze(t)}function tn(t,e){return tn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},tn(t,e)}var en=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Ze(e),function(t,e){if(e&&("object"==Ge(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Xe()?Reflect.construct(e,n||[],Ze(t).constructor):e.apply(t,n))}(this,e))._translations={zh:Ye(Ye({},t._translations.zh),{},{temperature:"温度",humidity:"湿度",mode:"模式"}),en:Ye(Ye({},t._translations.en),{},{temperature:"Temperature",humidity:"Humidity",mode:"Mode"})},t.addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Ye(Ye({},t),{},{climate_name:t.climate_name||("zh"===this._language?"未命名空调":"Unnamed AC"),entities:Array.isArray(null==t?void 0:t.entities)?$e(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_climate.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.climate_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("climate.")){var r,i,o=t._hass.states[e.entity_id],a=document.createElement("div");a.style.marginBottom="12px",a.style.padding="8px",a.style.border="1px solid #ddd",a.style.borderRadius="4px";var c=(null==o||null===(r=o.attributes)||void 0===r?void 0:r.current_temperature)||"--",u=(null==o||null===(i=o.attributes)||void 0===i?void 0:i.temperature)||"--";a.innerHTML='\n            <div style="margin-bottom: 8px;">\n              <strong>'.concat(e.entity_id,"</strong><br/>\n              ").concat(t._translations[t._language].temperature,": ").concat(c,"°C → ").concat(u,"°C\n            </div>\n          ");var l=t._createButton("On",function(){t._hass.callService("climate","turn_on",{entity_id:e.entity_id})}),s=t._createButton("Off",function(){t._hass.callService("climate","turn_off",{entity_id:e.entity_id})});a.appendChild(l),a.appendChild(s),n.appendChild(a)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=We().m(function t(){return We().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-climate-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){Fe(i,n,r,a,c,"next",t)}function c(t){Fe(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Je(n.prototype,r),i&&Je(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function nn(t){return nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nn(t)}function rn(t){return function(t){if(Array.isArray(t))return an(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||on(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(t,e){if(t){if("string"==typeof t)return an(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?an(t,e):void 0}}function an(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function cn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function un(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cn(Object(n),!0).forEach(function(e){ln(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ln(t,e,n){return(e=fn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,fn(r.key),r)}}function fn(t){var e=function(t){if("object"!=nn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=nn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==nn(e)?e:e+""}function pn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(pn=function(){return!!t})()}function dn(t){return dn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dn(t)}function yn(t,e){return yn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yn(t,e)}var hn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=dn(e),function(t,e){if(e&&("object"==nn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,pn()?Reflect.construct(e,n||[],dn(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=un(un({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?rn(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加空调":"Add Climate",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("climate.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=rn(n._config.entities);e[t]=un(un({},e[t]),{},{entity_id:o.value}),n._config=un(un({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:un({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=rn(n._config.entities);e.splice(t,1),n._config=un(un({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:un({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=rn(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||on(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=un(un({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:un({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&sn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function vn(t){return vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vn(t)}function bn(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return gn(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(gn(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,gn(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,gn(f,"constructor",l),gn(l,"constructor",u),u.displayName="GeneratorFunction",gn(l,i,"GeneratorFunction"),gn(f),gn(f,i,"Generator"),gn(f,r,function(){return this}),gn(f,"toString",function(){return"[object Generator]"}),(bn=function(){return{w:o,m:p}})()}function gn(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}gn=function(t,e,n,r){function o(e,n){gn(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},gn(t,e,n,r)}function mn(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function _n(t){return function(t){if(Array.isArray(t))return On(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return On(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?On(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function On(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function wn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function jn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wn(Object(n),!0).forEach(function(e){En(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function En(t,e,n){return(e=Pn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Pn(r.key),r)}}function Pn(t){var e=function(t){if("object"!=vn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=vn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==vn(e)?e:e+""}function Cn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Cn=function(){return!!t})()}function Tn(t){return Tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tn(t)}function xn(t,e){return xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xn(t,e)}var An=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Tn(e),function(t,e){if(e&&("object"==vn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Cn()?Reflect.construct(e,n||[],Tn(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=jn(jn({},t),{},{cover_name:t.cover_name||("zh"===this._language?"未命名窗帘":"Unnamed Cover"),entities:Array.isArray(null==t?void 0:t.entities)?_n(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_cover.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.cover_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("cover.")){var r,i,o=t._hass.states[e.entity_id],a=document.createElement("div");a.style.marginBottom="12px",a.style.padding="8px",a.style.border="1px solid #ddd",a.style.borderRadius="4px";var c=(null==o||null===(r=o.attributes)||void 0===r?void 0:r.current_position)||0;a.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong> - Position: ").concat(c,"%</div>");var u=t._createButton("Open",function(){t._hass.callService("cover","open_cover",{entity_id:e.entity_id})}),l=t._createButton("Close",function(){t._hass.callService("cover","close_cover",{entity_id:e.entity_id})}),s=t._createButton("Stop",function(){t._hass.callService("cover","stop_cover",{entity_id:e.entity_id})});if(a.appendChild(u),a.appendChild(l),a.appendChild(s),void 0!==(null==o||null===(i=o.attributes)||void 0===i?void 0:i.current_position)){var f=document.createElement("input");f.type="range",f.min="0",f.max="100",f.value=c,f.style.width="100%",f.style.marginTop="8px",f.addEventListener("change",function(n){t._hass.callService("cover","set_cover_position",{entity_id:e.entity_id,position:parseInt(n.target.value)})}),a.appendChild(f)}n.appendChild(a)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=bn().m(function t(){return bn().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-cover-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){mn(i,n,r,a,c,"next",t)}function c(t){mn(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Sn(n.prototype,r),i&&Sn(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function kn(t){return kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kn(t)}function Dn(t){return function(t){if(Array.isArray(t))return Ln(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Rn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rn(t,e){if(t){if("string"==typeof t)return Ln(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ln(t,e):void 0}}function Ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function In(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Mn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?In(Object(n),!0).forEach(function(e){Bn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):In(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Bn(t,e,n){return(e=zn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Un(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zn(r.key),r)}}function zn(t){var e=function(t){if("object"!=kn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=kn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kn(e)?e:e+""}function Hn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Hn=function(){return!!t})()}function Gn(t){return Gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gn(t)}function Wn(t,e){return Wn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wn(t,e)}var Nn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Gn(e),function(t,e){if(e&&("object"==kn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Hn()?Reflect.construct(e,n||[],Gn(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wn(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Mn(Mn({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Dn(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加窗帘":"Add Cover",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("cover.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=Dn(n._config.entities);e[t]=Mn(Mn({},e[t]),{},{entity_id:o.value}),n._config=Mn(Mn({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Mn({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Dn(n._config.entities);e.splice(t,1),n._config=Mn(Mn({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Mn({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=Dn(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||Rn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=Mn(Mn({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Mn({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&Un(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Fn(t){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fn(t)}function $n(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Vn(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Vn(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Vn(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Vn(f,"constructor",l),Vn(l,"constructor",u),u.displayName="GeneratorFunction",Vn(l,i,"GeneratorFunction"),Vn(f),Vn(f,i,"Generator"),Vn(f,r,function(){return this}),Vn(f,"toString",function(){return"[object Generator]"}),($n=function(){return{w:o,m:p}})()}function Vn(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Vn=function(t,e,n,r){function o(e,n){Vn(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},Vn(t,e,n,r)}function qn(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function Yn(t){return function(t){if(Array.isArray(t))return Kn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Kn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Jn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Qn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jn(Object(n),!0).forEach(function(e){Xn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Xn(t,e,n){return(e=tr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tr(r.key),r)}}function tr(t){var e=function(t){if("object"!=Fn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Fn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Fn(e)?e:e+""}function er(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(er=function(){return!!t})()}function nr(t){return nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nr(t)}function rr(t,e){return rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},rr(t,e)}var ir=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=nr(e),function(t,e){if(e&&("object"==Fn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,er()?Reflect.construct(e,n||[],nr(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rr(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Qn(Qn({},t),{},{switch_name:t.switch_name||("zh"===this._language?"未命名开关":"Unnamed Switch"),entities:Array.isArray(null==t?void 0:t.entities)?Yn(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_switch.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.switch_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("switch.")){var r=t._hass.states[e.entity_id],i=document.createElement("div");i.style.marginBottom="8px";var o="on"===(null==r?void 0:r.state)?t._translations[t._language].stateOn:t._translations[t._language].stateOff,a=t._createButton("".concat(e.entity_id,": ").concat(o),function(){var n="on"===(null==r?void 0:r.state)?"turn_off":"turn_on";t._hass.callService("switch",n,{entity_id:e.entity_id})});a.style.width="100%",a.style.padding="12px",i.appendChild(a),n.appendChild(i)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=$n().m(function t(){return $n().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-switch-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){qn(i,n,r,a,c,"next",t)}function c(t){qn(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Zn(n.prototype,r),i&&Zn(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function or(t){return or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},or(t)}function ar(t){return function(t){if(Array.isArray(t))return ur(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||cr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cr(t,e){if(t){if("string"==typeof t)return ur(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ur(t,e):void 0}}function ur(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function lr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function sr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lr(Object(n),!0).forEach(function(e){fr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function fr(t,e,n){return(e=dr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dr(r.key),r)}}function dr(t){var e=function(t){if("object"!=or(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==or(e)?e:e+""}function yr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(yr=function(){return!!t})()}function hr(t){return hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hr(t)}function vr(t,e){return vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},vr(t,e)}var br=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=hr(e),function(t,e){if(e&&("object"==or(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,yr()?Reflect.construct(e,n||[],hr(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vr(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=sr(sr({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?ar(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加开关":"Add Switch",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("switch.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=ar(n._config.entities);e[t]=sr(sr({},e[t]),{},{entity_id:o.value}),n._config=sr(sr({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:sr({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=ar(n._config.entities);e.splice(t,1),n._config=sr(sr({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:sr({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=ar(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||cr(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=sr(sr({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:sr({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&pr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function gr(t){return gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gr(t)}function mr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return _r(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(_r(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,_r(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,_r(f,"constructor",l),_r(l,"constructor",u),u.displayName="GeneratorFunction",_r(l,i,"GeneratorFunction"),_r(f),_r(f,i,"Generator"),_r(f,r,function(){return this}),_r(f,"toString",function(){return"[object Generator]"}),(mr=function(){return{w:o,m:p}})()}function _r(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}_r=function(t,e,n,r){function o(e,n){_r(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},_r(t,e,n,r)}function Or(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function wr(t){return function(t){if(Array.isArray(t))return jr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return jr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Er(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Sr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Er(Object(n),!0).forEach(function(e){Pr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Er(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Pr(t,e,n){return(e=Tr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Tr(r.key),r)}}function Tr(t){var e=function(t){if("object"!=gr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=gr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gr(e)?e:e+""}function xr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(xr=function(){return!!t})()}function Ar(t){return Ar=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ar(t)}function kr(t,e){return kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kr(t,e)}var Dr=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=Ar(e),function(t,e){if(e&&("object"==gr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,xr()?Reflect.construct(e,n||[],Ar(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kr(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Sr(Sr({},t),{},{weather_name:t.weather_name||("zh"===this._language?"未命名天气":"Unnamed Weather"),entities:Array.isArray(null==t?void 0:t.entities)?wr(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_weather.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.weather_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("weather.")){var r,i,o=t._hass.states[e.entity_id],a=document.createElement("div");a.style.marginBottom="12px",a.style.padding="8px",a.style.border="1px solid #ddd",a.style.borderRadius="4px";var c=(null==o||null===(r=o.attributes)||void 0===r?void 0:r.temperature)||"--",u=(null==o||null===(i=o.attributes)||void 0===i?void 0:i.humidity)||"--",l=(null==o?void 0:o.state)||"unknown";a.innerHTML='\n            <div style="margin-bottom: 8px;">\n              <strong>'.concat(e.entity_id,"</strong><br/>\n              状况: ").concat(l,"<br/>\n              温度: ").concat(c,"°C<br/>\n              湿度: ").concat(u,"%\n            </div>\n          "),n.appendChild(a)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=mr().m(function t(){return mr().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-weather-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){Or(i,n,r,a,c,"next",t)}function c(t){Or(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&Cr(n.prototype,r),i&&Cr(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function Rr(t){return Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rr(t)}function Lr(t){return function(t){if(Array.isArray(t))return Mr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ir(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(t,e){if(t){if("string"==typeof t)return Mr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mr(t,e):void 0}}function Mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Br(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Ur(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Br(Object(n),!0).forEach(function(e){zr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Br(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function zr(t,e,n){return(e=Gr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Gr(r.key),r)}}function Gr(t){var e=function(t){if("object"!=Rr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Rr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rr(e)?e:e+""}function Wr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Wr=function(){return!!t})()}function Nr(t){return Nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nr(t)}function Fr(t,e){return Fr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fr(t,e)}var $r=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=Nr(e),function(t,e){if(e&&("object"==Rr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Wr()?Reflect.construct(e,n||[],Nr(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fr(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Ur(Ur({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?Lr(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加天气":"Add Weather",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("weather.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=Lr(n._config.entities);e[t]=Ur(Ur({},e[t]),{},{entity_id:o.value}),n._config=Ur(Ur({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Ur({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=Lr(n._config.entities);e.splice(t,1),n._config=Ur(Ur({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Ur({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=Lr(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||Ir(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=Ur(Ur({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:Ur({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&Hr(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);function Vr(t){return Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vr(t)}function qr(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function o(n,r,i,o){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Yr(l,"_invoke",function(n,r,i){var o,c,u,l=0,s=i||[],f=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return o=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!f&&l&&!i&&e<s.length;e++){var i,o=s[e],d=p.p,y=o[2];n>3?(i=y===r)&&(u=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=d&&((i=n<2&&d<o[1])?(c=0,p.v=r,p.n=o[1]):d<y&&(i=n<3||o[0]>r||r>y)&&(o[4]=n,o[5]=r,p.n=y,c=0))}if(i||n>1)return a;throw f=!0,r}return function(i,s,y){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,y),c=s,u=y;(e=c<2?t:u)||!f;){o||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(l=2,o){if(c||(i="next"),e=o[i]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(u=TypeError("The iterator does not provide a '"+i+"' method"),c=1);o=t}else if((e=(f=p.n<0)?u:n.call(r,p))!==a)break}catch(e){o=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,i,o),!0),l}var a={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Yr(e={},r,function(){return this}),e),f=l.prototype=c.prototype=Object.create(s);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Yr(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Yr(f,"constructor",l),Yr(l,"constructor",u),u.displayName="GeneratorFunction",Yr(l,i,"GeneratorFunction"),Yr(f),Yr(f,i,"Generator"),Yr(f,r,function(){return this}),Yr(f,"toString",function(){return"[object Generator]"}),(qr=function(){return{w:o,m:p}})()}function Yr(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}Yr=function(t,e,n,r){function o(e,n){Yr(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(o("next",0),o("throw",1),o("return",2))},Yr(t,e,n,r)}function Kr(t,e,n,r,i,o,a){try{var c=t[o](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,i)}function Jr(t){return function(t){if(Array.isArray(t))return Qr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Qr(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qr(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Xr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Zr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xr(Object(n),!0).forEach(function(e){ti(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ti(t,e,n){return(e=ni(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ni(r.key),r)}}function ni(t){var e=function(t){if("object"!=Vr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Vr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vr(e)?e:e+""}function ri(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ri=function(){return!!t})()}function ii(t){return ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ii(t)}function oi(t,e){return oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oi(t,e)}var ai=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=ii(e),function(t,e){if(e&&("object"==Vr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ri()?Reflect.construct(e,n||[],ii(t).constructor):e.apply(t,n))}(this,e)).addEventListener("config-changed",function(e){t.setConfig(e.detail.config)}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oi(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=Zr(Zr({},t),{},{host_name:t.host_name||("zh"===this._language?"未命名主机":"Unnamed Host"),entities:Array.isArray(null==t?void 0:t.entities)?Jr(t.entities):[],icon_path:t.icon_path||"/local/community/RosCard/icon_img/icon_host.png"}),this._hass&&this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this._config&&this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._hass){this.innerHTML="";var e=document.createElement("ha-card");e.header=this._translations[this._language].cardTitle(this._config.host_name),e.appendChild(this._createIcon(this._config.icon_path));var n=document.createElement("div");n.style.padding="16px",n.style.position="relative",n.innerHTML="<h3>".concat(this._translations[this._language].controlPanelTitle,"</h3>"),Array.isArray(this._config.entities)&&this._config.entities.length>0&&this._config.entities.forEach(function(e){if(e.entity_id&&e.entity_id.startsWith("remote.")){t._hass.states[e.entity_id];var r=document.createElement("div");r.style.marginBottom="12px",r.style.padding="8px",r.style.border="1px solid #ddd",r.style.borderRadius="4px",r.innerHTML='<div style="margin-bottom: 8px;"><strong>'.concat(e.entity_id,"</strong></div>"),(e.commands||[]).forEach(function(n){var i=t._createButton(n.label||n,function(){t._hass.callService("remote","send_command",{entity_id:e.entity_id,command:n.value||n})});r.appendChild(i)}),n.appendChild(r)}}),e.appendChild(n),this.appendChild(e)}}},{key:"getCardSize",value:function(){return 4}}],i=[{key:"getConfigElement",value:(o=qr().m(function t(){return qr().w(function(t){for(;;)if(0===t.n)return t.a(2,document.createElement("aiks-host-card-editor"))},t)}),a=function(){var t=this,e=arguments;return new Promise(function(n,r){var i=o.apply(t,e);function a(t){Kr(i,n,r,a,c,"next",t)}function c(t){Kr(i,n,r,a,c,"throw",t)}a(void 0)})},function(){return a.apply(this,arguments)})},{key:"getStubConfig",value:function(){return{entities:[]}}}],r&&ei(n.prototype,r),i&&ei(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o,a}(u);function ci(t){return ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ci(t)}function ui(t){return function(t){if(Array.isArray(t))return si(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||li(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function li(t,e){if(t){if("string"==typeof t)return si(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?si(t,e):void 0}}function si(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function fi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function pi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fi(Object(n),!0).forEach(function(e){di(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fi(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function di(t,e,n){return(e=hi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,hi(r.key),r)}}function hi(t){var e=function(t){if("object"!=ci(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ci(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ci(e)?e:e+""}function vi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(vi=function(){return!!t})()}function bi(t){return bi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bi(t)}function gi(t,e){return gi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gi(t,e)}var mi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=bi(e),function(t,e){if(e&&("object"==ci(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,vi()?Reflect.construct(e,n||[],bi(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gi(t,e)}(e,t),n=e,r=[{key:"setConfig",value:function(t){this._config=pi(pi({},t),{},{entities:Array.isArray(null==t?void 0:t.entities)?ui(t.entities):[]}),this.render()}},{key:"hass",set:function(t){this._hass=t,this.firstRender&&(this.render(),this.firstRender=!1)}},{key:"render",value:function(){var t=this;if(this._config&&this._hass){this.innerHTML="";var e=document.createElement("div");e.style.padding="16px";var n=document.createElement("div");n.id="entityContainer",n.style.minHeight="100px",this._config.entities.forEach(function(e,r){var i=t._createEntityRow(r,e);n.appendChild(i)});var r=this._createButton("zh"===this._language?"添加主机":"Add Host",function(){t._config.entities.push({entity_id:""}),t.dispatchEvent(new CustomEvent("config-changed",{detail:{config:t._config},bubbles:!0,composed:!0})),t.render()});e.appendChild(n),e.appendChild(r),this.appendChild(e),this._setupDragAndDrop(n)}}},{key:"_createEntityRow",value:function(t,e){var n=this,r=document.createElement("div");r.style.marginBottom="10px",r.style.display="flex",r.style.alignItems="center",r.draggable=!0,r.dataset.index=t,r.style.cursor="move";var i=document.createElement("span");i.innerText=this._translations[this._language].selectEntity+": ",i.style.width="100px",r.appendChild(i);var o=document.createElement("select");o.style.width="250px",o.innerHTML='<option value="">'.concat(this._translations[this._language].selectEntity,"</option>"),Object.keys(this._hass.states).forEach(function(t){if(t.startsWith("remote.")){var r,i=document.createElement("option");i.value=t;var a=(null===(r=n._hass.states[t])||void 0===r||null===(r=r.attributes)||void 0===r?void 0:r.friendly_name)||t;i.text="".concat(a," (").concat(t,")"),t===e.entity_id&&(i.selected=!0),o.appendChild(i)}}),o.addEventListener("change",function(){var e=ui(n._config.entities);e[t]=pi(pi({},e[t]),{},{entity_id:o.value}),n._config=pi(pi({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:pi({},n._config)}})),n.render()}),r.appendChild(o);var a=this._createButton("zh"===this._language?"删除":"Delete",function(){var e=ui(n._config.entities);e.splice(t,1),n._config=pi(pi({},n._config),{},{entities:e}),n.dispatchEvent(new CustomEvent("config-changed",{detail:{config:pi({},n._config)}})),n.render()});return r.appendChild(a),r}},{key:"_setupDragAndDrop",value:function(t){var e=this,n=null;t.addEventListener("dragstart",function(t){var e=t.target;e.draggable&&(n=parseInt(e.dataset.index),t.dataTransfer.setData("text/plain",n),e.style.opacity="0.5")}),t.addEventListener("dragover",function(t){t.preventDefault()}),t.addEventListener("drop",function(r){if(r.preventDefault(),null!==n){var i=parseInt(r.target.dataset.index);if(!isNaN(i)&&n!==i){var o=ui(e._config.entities),a=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,c=[],u=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,i=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(t,e)||li(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o.splice(n,1),1)[0];o.splice(i,0,a),e._config=pi(pi({},e._config),{},{entities:o}),e.dispatchEvent(new CustomEvent("config-changed",{detail:{config:pi({},e._config)}})),e.render()}n=null,t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})}}),t.addEventListener("dragend",function(e){null!==n&&t.querySelectorAll("[draggable]").forEach(function(t){return t.style.opacity="1"})})}}],r&&yi(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(u);customElements.define("aiks-tv-card",E),customElements.define("aiks-tv-card-editor",M),customElements.define("aiks-light-card",Q),customElements.define("aiks-light-card-editor",st),customElements.define("aiks-fan-card",St),customElements.define("aiks-fan-card-editor",Ut),customElements.define("aiks-scene-card",Zt),customElements.define("aiks-scene-card-editor",pe),customElements.define("aiks-media-player-card",Ce),customElements.define("aiks-media-player-card-editor",He),customElements.define("aiks-climate-card",en),customElements.define("aiks-climate-card-editor",hn),customElements.define("aiks-cover-card",An),customElements.define("aiks-cover-card-editor",Nn),customElements.define("aiks-switch-card",ir),customElements.define("aiks-switch-card-editor",br),customElements.define("aiks-weather-card",Dr),customElements.define("aiks-weather-card-editor",$r),customElements.define("aiks-host-card",ai),customElements.define("aiks-host-card-editor",mi),window.customCards=window.customCards||[],window.customCards.push({type:"aiks-tv-card",name:navigator.language.startsWith("zh")?"电视(ROS)":"TV(ROS)",description:navigator.language.startsWith("zh")?"电视卡片":"TV Card",preview:!0},{type:"aiks-light-card",name:navigator.language.startsWith("zh")?"灯光(ROS)":"Light(ROS)",description:navigator.language.startsWith("zh")?"灯光卡片":"Light Card",preview:!0},{type:"aiks-fan-card",name:navigator.language.startsWith("zh")?"风扇(ROS)":"Fan(ROS)",description:navigator.language.startsWith("zh")?"风扇卡片":"Fan Card",preview:!0},{type:"aiks-scene-card",name:navigator.language.startsWith("zh")?"场景(ROS)":"Scene(ROS)",description:navigator.language.startsWith("zh")?"场景卡片":"Scene Card",preview:!0},{type:"aiks-media-player-card",name:navigator.language.startsWith("zh")?"媒体播放器(ROS)":"Media Player(ROS)",description:navigator.language.startsWith("zh")?"媒体播放器卡片":"Media Player Card",preview:!0},{type:"aiks-climate-card",name:navigator.language.startsWith("zh")?"空调(ROS)":"AC(ROS)",description:navigator.language.startsWith("zh")?"空调卡片":"AC Card",preview:!0},{type:"aiks-cover-card",name:navigator.language.startsWith("zh")?"窗帘(ROS)":"Cover(ROS)",description:navigator.language.startsWith("zh")?"窗帘卡片":"Cover Card",preview:!0},{type:"aiks-switch-card",name:navigator.language.startsWith("zh")?"开关(ROS)":"Switch(ROS)",description:navigator.language.startsWith("zh")?"开关卡片":"Switch Card",preview:!0},{type:"aiks-weather-card",name:navigator.language.startsWith("zh")?"天气(ROS)":"Weather(ROS)",description:navigator.language.startsWith("zh")?"天气卡片":"Weather Card",preview:!0},{type:"aiks-host-card",name:navigator.language.startsWith("zh")?"主机(ROS)":"Host(ROS)",description:navigator.language.startsWith("zh")?"主机卡片":"Host Card",preview:!0}),console.log("✅ Aiks Custom Cards loaded successfully!")})();
//# sourceMappingURL=RosCard.js.map